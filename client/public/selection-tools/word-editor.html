<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>Wordæ–‡æ¡£ç¼–è¾‘å™¨ - è®¾å¤‡å‚æ•°é€‰å‹ç³»ç»Ÿ</title>
	
	<!-- Tiptapæ ¸å¿ƒåº“ - ä½¿ç”¨å›½å†…CDNé•œåƒ -->
	<script src="https://cdn.jsdelivr.net/npm/@tiptap/core@2.1.13/dist/tiptap-core.umd.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@tiptap/starter-kit@2.1.13/dist/tiptap-starter-kit.umd.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@tiptap/extension-text-style@2.1.13/dist/tiptap-extension-text-style.umd.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@tiptap/extension-color@2.1.13/dist/tiptap-extension-color.umd.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@tiptap/extension-text-align@2.1.13/dist/tiptap-extension-text-align.umd.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@tiptap/extension-table@2.1.13/dist/tiptap-extension-table.umd.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@tiptap/extension-table-row@2.1.13/dist/tiptap-extension-table-row.umd.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@tiptap/extension-table-cell@2.1.13/dist/tiptap-extension-table-cell.umd.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@tiptap/extension-table-header@2.1.13/dist/tiptap-extension-table-header.umd.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@tiptap/extension-image@2.1.13/dist/tiptap-extension-image.umd.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@tiptap/extension-link@2.1.13/dist/tiptap-extension-link.umd.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@tiptap/extension-underline@2.1.13/dist/tiptap-extension-underline.umd.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@tiptap/extension-font-family@2.1.13/dist/tiptap-extension-font-family.umd.min.js"></script>
	<script src="https://cdn.jsdelivr.net/npm/@tiptap/extension-highlight@2.1.13/dist/tiptap-extension-highlight.umd.min.js"></script>
	
	<style>
		* {
			margin: 0;
			padding: 0;
			box-sizing: border-box;
		}
		
		body {
			font-family: 'Microsoft YaHei', 'å¾®è½¯é›…é»‘', 'SimSun', 'å®‹ä½“', sans-serif;
			background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
			min-height: 100vh;
			display: flex;
			flex-direction: column;
		}
		
		/* é¡¶éƒ¨å·¥å…·æ  */
		.top-toolbar {
			background: white;
			box-shadow: 0 2px 8px rgba(0, 0, 0, 0.1);
			padding: 12px 20px;
			display: flex;
			justify-content: space-between;
			align-items: center;
			z-index: 1000;
		}
		
		.top-toolbar-left {
			display: flex;
			align-items: center;
			gap: 15px;
		}
		
		.top-toolbar-right {
			display: flex;
			gap: 10px;
		}
		
		.logo {
			font-size: 18px;
			font-weight: bold;
			color: #667eea;
			display: flex;
			align-items: center;
			gap: 8px;
		}
		
		.btn {
			padding: 8px 16px;
			border: none;
			border-radius: 6px;
			cursor: pointer;
			font-size: 14px;
			font-weight: 500;
			transition: all 0.3s;
			display: flex;
			align-items: center;
			gap: 6px;
		}
		
		.btn-primary {
			background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
			color: white;
		}
		
		.btn-primary:hover {
			transform: translateY(-2px);
			box-shadow: 0 4px 12px rgba(102, 126, 234, 0.4);
		}
		
		.btn-secondary {
			background: #f5f5f5;
			color: #333;
		}
		
		.btn-secondary:hover {
			background: #e0e0e0;
		}
		
		.btn-danger {
			background: #ff4444;
			color: white;
		}
		
		.btn-danger:hover {
			background: #cc0000;
		}
		
		/* ç¼–è¾‘å™¨å®¹å™¨ */
		.editor-container {
			flex: 1;
			display: flex;
			flex-direction: column;
			padding: 20px;
			overflow: auto;
		}
		
		.editor-wrapper {
			max-width: 900px;
			margin: 0 auto;
			width: 100%;
			background: white;
			border-radius: 12px;
			box-shadow: 0 8px 32px rgba(0, 0, 0, 0.2);
			overflow: hidden;
		}
		
		/* Tiptapå·¥å…·æ  */
		.tiptap-toolbar {
			background: #f8f9fa;
			border-bottom: 2px solid #e9ecef;
			padding: 12px;
			display: flex;
			flex-wrap: wrap;
			gap: 8px;
			align-items: center;
		}
		
		.toolbar-group {
			display: flex;
			gap: 4px;
			padding: 4px;
			border-radius: 6px;
			background: white;
		}
		
		.toolbar-btn {
			padding: 6px 10px;
			border: 1px solid #dee2e6;
			border-radius: 4px;
			background: white;
			cursor: pointer;
			font-size: 14px;
			transition: all 0.2s;
			display: flex;
			align-items: center;
			justify-content: center;
			min-width: 32px;
			height: 32px;
		}
		
		.toolbar-btn:hover {
			background: #e7f3ff;
			border-color: #667eea;
			color: #667eea;
		}
		
		.toolbar-btn.is-active {
			background: #667eea;
			color: white;
			border-color: #667eea;
		}
		
		.toolbar-select {
			padding: 6px 10px;
			border: 1px solid #dee2e6;
			border-radius: 4px;
			background: white;
			cursor: pointer;
			font-size: 14px;
			min-width: 120px;
		}
		
		.toolbar-select:focus {
			outline: none;
			border-color: #667eea;
		}
		
		.toolbar-separator {
			width: 1px;
			height: 24px;
			background: #dee2e6;
			margin: 0 4px;
		}
		
		/* Tiptapç¼–è¾‘åŒº */
		.tiptap-editor {
			min-height: 600px;
			padding: 60px 80px;
			font-size: 14px;
			line-height: 1.8;
			color: #333;
		}
		
		.tiptap-editor:focus {
			outline: none;
		}
		
		/* ç¼–è¾‘å™¨å†…å®¹æ ·å¼ */
		.tiptap-editor h1 {
			font-size: 32px;
			font-weight: bold;
			margin: 24px 0 16px 0;
			color: #1a1a1a;
		}
		
		.tiptap-editor h2 {
			font-size: 28px;
			font-weight: bold;
			margin: 20px 0 14px 0;
			color: #1a1a1a;
		}
		
		.tiptap-editor h3 {
			font-size: 24px;
			font-weight: bold;
			margin: 18px 0 12px 0;
			color: #1a1a1a;
		}
		
		.tiptap-editor h4 {
			font-size: 20px;
			font-weight: bold;
			margin: 16px 0 10px 0;
			color: #1a1a1a;
		}
		
		.tiptap-editor p {
			margin: 12px 0;
		}
		
		.tiptap-editor ul,
		.tiptap-editor ol {
			padding-left: 30px;
			margin: 12px 0;
		}
		
		.tiptap-editor li {
			margin: 6px 0;
		}
		
		.tiptap-editor blockquote {
			border-left: 4px solid #667eea;
			padding-left: 20px;
			margin: 20px 0;
			color: #666;
			font-style: italic;
		}
		
		.tiptap-editor code {
			background: #f5f5f5;
			padding: 2px 6px;
			border-radius: 3px;
			font-family: 'Courier New', monospace;
			font-size: 0.9em;
		}
		
		.tiptap-editor pre {
			background: #2d2d2d;
			color: #f8f8f2;
			padding: 16px;
			border-radius: 6px;
			overflow-x: auto;
			margin: 16px 0;
		}
		
		.tiptap-editor pre code {
			background: transparent;
			color: inherit;
			padding: 0;
		}
		
		.tiptap-editor table {
			border-collapse: collapse;
			width: 100%;
			margin: 20px 0;
		}
		
		.tiptap-editor table td,
		.tiptap-editor table th {
			border: 1px solid #dee2e6;
			padding: 10px 14px;
			text-align: left;
		}
		
		.tiptap-editor table th {
			background: #f8f9fa;
			font-weight: bold;
		}
		
		.tiptap-editor img {
			max-width: 100%;
			height: auto;
			display: block;
			margin: 20px auto;
			border-radius: 6px;
		}
		
		.tiptap-editor a {
			color: #667eea;
			text-decoration: underline;
		}
		
		.tiptap-editor a:hover {
			color: #764ba2;
		}
		
		.tiptap-editor hr {
			border: none;
			border-top: 2px solid #e9ecef;
			margin: 24px 0;
		}
		
		.tiptap-editor mark {
			background: #fff3cd;
			padding: 2px 4px;
			border-radius: 2px;
		}
		
		/* æ‰“å°æ ·å¼ */
		@media print {
			.top-toolbar {
				display: none;
			}
			
			.editor-container {
				padding: 0;
			}
			
			.editor-wrapper {
				box-shadow: none;
				max-width: 100%;
			}
			
			.tiptap-toolbar {
				display: none;
			}
		}
		
		/* å“åº”å¼ */
		@media (max-width: 768px) {
			.tiptap-editor {
				padding: 40px 20px;
			}
			
			.toolbar-group {
				gap: 2px;
			}
			
			.toolbar-btn {
				min-width: 28px;
				height: 28px;
				font-size: 12px;
			}
		}
	</style>
</head>
<body>
	<!-- é¡¶éƒ¨å·¥å…·æ  -->
	<div class="top-toolbar">
		<div class="top-toolbar-left">
			<div class="logo">
				ğŸ“ Wordæ–‡æ¡£ç¼–è¾‘å™¨
			</div>
			<button class="btn btn-secondary" onclick="window.location.href='index.html'">
				â† è¿”å›é€‰å‹è¡¨
			</button>
		</div>
		<div class="top-toolbar-right">
			<button class="btn btn-primary" id="saveBtn">ğŸ’¾ ä¿å­˜</button>
			<button class="btn btn-secondary" id="exportPdfBtn">ğŸ“„ å¯¼å‡ºPDF</button>
			<button class="btn btn-secondary" id="exportHtmlBtn">ğŸŒ å¯¼å‡ºHTML</button>
			<button class="btn btn-danger" id="clearBtn">ğŸ—‘ï¸ æ¸…ç©º</button>
		</div>
	</div>
	
	<!-- ç¼–è¾‘å™¨å®¹å™¨ -->
	<div class="editor-container">
		<div class="editor-wrapper">
			<!-- Tiptapå·¥å…·æ  -->
			<div class="tiptap-toolbar" id="toolbar">
				<!-- å·¥å…·æ å°†ç”±JavaScriptåŠ¨æ€ç”Ÿæˆ -->
			</div>
			
			<!-- Tiptapç¼–è¾‘åŒº -->
			<div class="tiptap-editor" id="editor"></div>
		</div>
	</div>
	
	<script>
		console.log('ğŸ“ Wordç¼–è¾‘å™¨é¡µé¢åŠ è½½ä¸­...');
		
		// ç­‰å¾…æ‰€æœ‰Tiptapåº“åŠ è½½å®Œæˆ
		function waitForTiptap() {
			return new Promise((resolve) => {
				const checkLibs = () => {
					if (window.TiptapCore && 
						window.TiptapStarterKit && 
						window.TiptapTextStyle && 
						window.TiptapColor && 
						window.TiptapTextAlign && 
						window.TiptapTable && 
						window.TiptapTableRow && 
						window.TiptapTableCell && 
						window.TiptapTableHeader && 
						window.TiptapImage && 
						window.TiptapLink && 
						window.TiptapUnderline && 
						window.TiptapFontFamily &&
						window.TiptapHighlight) {
						resolve();
					} else {
						setTimeout(checkLibs, 100);
					}
				};
				checkLibs();
			});
		}
		
		// åˆå§‹åŒ–ç¼–è¾‘å™¨
		async function initEditor() {
			console.log('â³ ç­‰å¾…Tiptapåº“åŠ è½½...');
			await waitForTiptap();
			console.log('âœ… Tiptapåº“åŠ è½½å®Œæˆ');
			
			// åˆ›å»ºç¼–è¾‘å™¨å®ä¾‹
			const editor = new TiptapCore.Editor({
				element: document.querySelector('#editor'),
				extensions: [
					TiptapStarterKit.StarterKit.configure({
						heading: {
							levels: [1, 2, 3, 4, 5, 6]
						}
					}),
					TiptapTextStyle.TextStyle,
					TiptapColor.Color,
					TiptapTextAlign.TextAlign.configure({
						types: ['heading', 'paragraph']
					}),
					TiptapTable.Table.configure({
						resizable: true,
						HTMLAttributes: {
							style: 'border-collapse: collapse; width: 100%;'
						}
					}),
					TiptapTableRow.TableRow,
					TiptapTableCell.TableCell,
					TiptapTableHeader.TableHeader,
					TiptapImage.Image,
					TiptapLink.Link.configure({
						openOnClick: false,
						HTMLAttributes: {
							class: 'editor-link'
						}
					}),
					TiptapUnderline.Underline,
					TiptapFontFamily.FontFamily,
					TiptapHighlight.Highlight.configure({
						multicolor: true
					})
				],
				content: '',
				editorProps: {
					attributes: {
						class: 'tiptap-editor'
					}
				},
				onUpdate: ({ editor }) => {
					// è‡ªåŠ¨ä¿å­˜
					clearTimeout(window.autoSaveTimer);
					window.autoSaveTimer = setTimeout(() => {
						const html = editor.getHTML();
						localStorage.setItem('wordEditorContent', html);
						console.log('ğŸ’¾ å†…å®¹å·²è‡ªåŠ¨ä¿å­˜');
					}, 3000);
				}
			});
			
			window.editor = editor;
			console.log('âœ… ç¼–è¾‘å™¨å®ä¾‹åˆ›å»ºæˆåŠŸ');
			
			// åˆ›å»ºå·¥å…·æ 
			createToolbar(editor);
			
			// åŠ è½½ä¿å­˜çš„å†…å®¹
			loadContent(editor);
			
			// ç»‘å®šæŒ‰é’®äº‹ä»¶
			bindButtons(editor);
		}
		
		// åˆ›å»ºå·¥å…·æ 
		function createToolbar(editor) {
			const toolbar = document.getElementById('toolbar');
			
			toolbar.innerHTML = `
				<!-- æ–‡æœ¬æ ¼å¼ç»„ -->
				<div class="toolbar-group">
					<select id="headingSelect" class="toolbar-select" title="æ ‡é¢˜">
						<option value="">æ­£æ–‡</option>
						<option value="1">æ ‡é¢˜ 1</option>
						<option value="2">æ ‡é¢˜ 2</option>
						<option value="3">æ ‡é¢˜ 3</option>
						<option value="4">æ ‡é¢˜ 4</option>
						<option value="5">æ ‡é¢˜ 5</option>
						<option value="6">æ ‡é¢˜ 6</option>
					</select>
					
					<select id="fontSelect" class="toolbar-select" title="å­—ä½“">
						<option value="">é»˜è®¤å­—ä½“</option>
						<option value="SimSun">å®‹ä½“</option>
						<option value="SimHei">é»‘ä½“</option>
						<option value="Microsoft YaHei">å¾®è½¯é›…é»‘</option>
						<option value="KaiTi">æ¥·ä½“</option>
						<option value="FangSong">ä»¿å®‹</option>
						<option value="Arial">Arial</option>
						<option value="Times New Roman">Times New Roman</option>
					</select>
				</div>
				
				<div class="toolbar-separator"></div>
				
				<!-- æ–‡æœ¬æ ·å¼ç»„ -->
				<div class="toolbar-group">
					<button class="toolbar-btn" data-action="bold" title="ç²—ä½“ (Ctrl+B)"><b>B</b></button>
					<button class="toolbar-btn" data-action="italic" title="æ–œä½“ (Ctrl+I)"><i>I</i></button>
					<button class="toolbar-btn" data-action="underline" title="ä¸‹åˆ’çº¿ (Ctrl+U)"><u>U</u></button>
					<button class="toolbar-btn" data-action="strike" title="åˆ é™¤çº¿"><s>S</s></button>
					<button class="toolbar-btn" data-action="highlight" title="é«˜äº®">ğŸ–</button>
				</div>
				
				<div class="toolbar-separator"></div>
				
				<!-- å¯¹é½ç»„ -->
				<div class="toolbar-group">
					<button class="toolbar-btn" data-action="alignLeft" title="å·¦å¯¹é½">â¬…ï¸</button>
					<button class="toolbar-btn" data-action="alignCenter" title="å±…ä¸­">â¬†ï¸</button>
					<button class="toolbar-btn" data-action="alignRight" title="å³å¯¹é½">â¡ï¸</button>
					<button class="toolbar-btn" data-action="alignJustify" title="ä¸¤ç«¯å¯¹é½">â†”ï¸</button>
				</div>
				
				<div class="toolbar-separator"></div>
				
				<!-- åˆ—è¡¨ç»„ -->
				<div class="toolbar-group">
					<button class="toolbar-btn" data-action="bulletList" title="æ— åºåˆ—è¡¨">â€¢ åˆ—è¡¨</button>
					<button class="toolbar-btn" data-action="orderedList" title="æœ‰åºåˆ—è¡¨">1. åˆ—è¡¨</button>
				</div>
				
				<div class="toolbar-separator"></div>
				
				<!-- æ’å…¥ç»„ -->
				<div class="toolbar-group">
					<button class="toolbar-btn" data-action="blockquote" title="å¼•ç”¨">â</button>
					<button class="toolbar-btn" data-action="codeBlock" title="ä»£ç å—">&lt;/&gt;</button>
					<button class="toolbar-btn" data-action="horizontalRule" title="åˆ†éš”çº¿">â”€â”€â”€</button>
				</div>
				
				<div class="toolbar-separator"></div>
				
				<!-- è¡¨æ ¼å’Œåª’ä½“ç»„ -->
				<div class="toolbar-group">
					<button class="toolbar-btn" data-action="insertTable" title="æ’å…¥è¡¨æ ¼ (3x3)">ğŸ“Š</button>
					<button class="toolbar-btn" data-action="link" title="æ’å…¥é“¾æ¥">ğŸ”—</button>
					<button class="toolbar-btn" data-action="image" title="æ’å…¥å›¾ç‰‡">ğŸ–¼ï¸</button>
				</div>
				
				<div class="toolbar-separator"></div>
				
				<!-- æ’¤é”€é‡åšç»„ -->
				<div class="toolbar-group">
					<button class="toolbar-btn" data-action="undo" title="æ’¤é”€ (Ctrl+Z)">â†¶</button>
					<button class="toolbar-btn" data-action="redo" title="é‡åš (Ctrl+Y)">â†·</button>
				</div>
			`;
			
			// ç»‘å®šå·¥å…·æ äº‹ä»¶
			bindToolbarEvents(editor);
		}
		
		// ç»‘å®šå·¥å…·æ äº‹ä»¶
		function bindToolbarEvents(editor) {
			// æ ‡é¢˜é€‰æ‹©
			document.getElementById('headingSelect').addEventListener('change', (e) => {
				const level = e.target.value;
				if (level === '') {
					editor.chain().focus().setParagraph().run();
				} else {
					editor.chain().focus().toggleHeading({ level: parseInt(level) }).run();
				}
			});
			
			// å­—ä½“é€‰æ‹©
			document.getElementById('fontSelect').addEventListener('change', (e) => {
				const font = e.target.value;
				if (font) {
					editor.chain().focus().setFontFamily(font).run();
				} else {
					editor.chain().focus().unsetFontFamily().run();
				}
			});
			
			// å·¥å…·æŒ‰é’®
			document.querySelectorAll('.toolbar-btn[data-action]').forEach(btn => {
				btn.addEventListener('click', () => {
					const action = btn.getAttribute('data-action');
					handleAction(editor, action);
					updateToolbarState(editor);
				});
			});
			
			// ç›‘å¬ç¼–è¾‘å™¨çŠ¶æ€å˜åŒ–ï¼Œæ›´æ–°å·¥å…·æ 
			editor.on('selectionUpdate', () => updateToolbarState(editor));
			editor.on('transaction', () => updateToolbarState(editor));
		}
		
		// å¤„ç†å·¥å…·æ æ“ä½œ
		function handleAction(editor, action) {
			switch(action) {
				case 'bold':
					editor.chain().focus().toggleBold().run();
					break;
				case 'italic':
					editor.chain().focus().toggleItalic().run();
					break;
				case 'underline':
					editor.chain().focus().toggleUnderline().run();
					break;
				case 'strike':
					editor.chain().focus().toggleStrike().run();
					break;
				case 'highlight':
					editor.chain().focus().toggleHighlight({ color: '#fff3cd' }).run();
					break;
				case 'alignLeft':
					editor.chain().focus().setTextAlign('left').run();
					break;
				case 'alignCenter':
					editor.chain().focus().setTextAlign('center').run();
					break;
				case 'alignRight':
					editor.chain().focus().setTextAlign('right').run();
					break;
				case 'alignJustify':
					editor.chain().focus().setTextAlign('justify').run();
					break;
				case 'bulletList':
					editor.chain().focus().toggleBulletList().run();
					break;
				case 'orderedList':
					editor.chain().focus().toggleOrderedList().run();
					break;
				case 'blockquote':
					editor.chain().focus().toggleBlockquote().run();
					break;
				case 'codeBlock':
					editor.chain().focus().toggleCodeBlock().run();
					break;
				case 'horizontalRule':
					editor.chain().focus().setHorizontalRule().run();
					break;
				case 'insertTable':
					editor.chain().focus().insertTable({ rows: 3, cols: 3, withHeaderRow: true }).run();
					break;
				case 'link':
					const url = prompt('è¾“å…¥é“¾æ¥URL:');
					if (url) {
						editor.chain().focus().setLink({ href: url }).run();
					}
					break;
				case 'image':
					const imgUrl = prompt('è¾“å…¥å›¾ç‰‡URL:');
					if (imgUrl) {
						editor.chain().focus().setImage({ src: imgUrl }).run();
					}
					break;
				case 'undo':
					editor.chain().focus().undo().run();
					break;
				case 'redo':
					editor.chain().focus().redo().run();
					break;
			}
		}
		
		// æ›´æ–°å·¥å…·æ çŠ¶æ€
		function updateToolbarState(editor) {
			document.querySelectorAll('.toolbar-btn[data-action]').forEach(btn => {
				const action = btn.getAttribute('data-action');
				const isActive = checkActive(editor, action);
				btn.classList.toggle('is-active', isActive);
			});
		}
		
		// æ£€æŸ¥æŒ‰é’®æ˜¯å¦æ¿€æ´»
		function checkActive(editor, action) {
			switch(action) {
				case 'bold': return editor.isActive('bold');
				case 'italic': return editor.isActive('italic');
				case 'underline': return editor.isActive('underline');
				case 'strike': return editor.isActive('strike');
				case 'highlight': return editor.isActive('highlight');
				case 'bulletList': return editor.isActive('bulletList');
				case 'orderedList': return editor.isActive('orderedList');
				case 'blockquote': return editor.isActive('blockquote');
				case 'codeBlock': return editor.isActive('codeBlock');
				case 'alignLeft': return editor.isActive({ textAlign: 'left' });
				case 'alignCenter': return editor.isActive({ textAlign: 'center' });
				case 'alignRight': return editor.isActive({ textAlign: 'right' });
				case 'alignJustify': return editor.isActive({ textAlign: 'justify' });
				default: return false;
			}
		}
		
		// åŠ è½½å†…å®¹
		function loadContent(editor) {
			const savedContent = localStorage.getItem('wordEditorContent');
			if (savedContent) {
				editor.commands.setContent(savedContent);
				console.log('ğŸ“‚ å·²åŠ è½½ä¿å­˜çš„å†…å®¹');
			} else {
				// è®¾ç½®é»˜è®¤å†…å®¹
				const defaultHTML = `
					<h1 style="text-align: center;">è®¾å¤‡å‚æ•°é€‰å‹æ–‡æ¡£</h1>
					<p style="text-align: center;"><em>Device Parameter Selection Document</em></p>
					<hr>
					<h2>é¡¹ç›®æ¦‚è¿°</h2>
					<p>åœ¨æ­¤è¾“å…¥é¡¹ç›®çš„åŸºæœ¬ä¿¡æ¯å’Œæ¦‚è¿°...</p>
					<h2>è®¾å¤‡æ¸…å•</h2>
					<p>åœ¨æ­¤è¾“å…¥è®¾å¤‡æ¸…å•å†…å®¹...</p>
					<p><mark>æç¤ºï¼šç‚¹å‡»å·¥å…·æ çš„"ğŸ“Š"æŒ‰é’®å¯ä»¥æ’å…¥è¡¨æ ¼ï¼Œæ‚¨ä¹Ÿå¯ä»¥ä»é€‰å‹è¡¨é¡µé¢å¯¼å…¥æ•°æ®</mark></p>
					<h2>æŠ€æœ¯å‚æ•°è¯´æ˜</h2>
					<p>åœ¨æ­¤è¾“å…¥è¯¦ç»†çš„æŠ€æœ¯å‚æ•°è¯´æ˜...</p>
				`;
				editor.commands.setContent(defaultHTML);
			}
		}
		
		// ç»‘å®šæŒ‰é’®äº‹ä»¶
		function bindButtons(editor) {
			// ä¿å­˜æŒ‰é’®
			document.getElementById('saveBtn').addEventListener('click', () => {
				const html = editor.getHTML();
				localStorage.setItem('wordEditorContent', html);
				alert('âœ… æ–‡æ¡£å·²ä¿å­˜åˆ°æœ¬åœ°ï¼');
				console.log('ğŸ’¾ æ–‡æ¡£å·²ä¿å­˜');
			});
			
			// å¯¼å‡ºPDFæŒ‰é’®ï¼ˆé€šè¿‡æ‰“å°ï¼‰
			document.getElementById('exportPdfBtn').addEventListener('click', () => {
				window.print();
				console.log('ğŸ“„ æ‰“å¼€æ‰“å°å¯¹è¯æ¡†');
			});
			
			// å¯¼å‡ºHTMLæŒ‰é’®
			document.getElementById('exportHtmlBtn').addEventListener('click', () => {
				const content = editor.getHTML();
				const blob = new Blob([`
<!DOCTYPE html>
<html lang="zh-CN">
<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	<title>è®¾å¤‡å‚æ•°é€‰å‹æ–‡æ¡£</title>
	<style>
		body {
			font-family: 'Microsoft YaHei', 'å¾®è½¯é›…é»‘', 'SimSun', 'å®‹ä½“', sans-serif;
			font-size: 14px;
			line-height: 1.8;
			padding: 60px 80px;
			max-width: 900px;
			margin: 0 auto;
			color: #333;
		}
		h1, h2, h3, h4, h5, h6 {
			font-weight: bold;
			color: #1a1a1a;
		}
		table {
			border-collapse: collapse;
			width: 100%;
			margin: 20px 0;
		}
		table td, table th {
			border: 1px solid #dee2e6;
			padding: 10px 14px;
		}
		table th {
			background: #f8f9fa;
			font-weight: bold;
		}
		img {
			max-width: 100%;
			height: auto;
		}
		code {
			background: #f5f5f5;
			padding: 2px 6px;
			border-radius: 3px;
			font-family: 'Courier New', monospace;
		}
		pre {
			background: #2d2d2d;
			color: #f8f8f2;
			padding: 16px;
			border-radius: 6px;
			overflow-x: auto;
		}
		blockquote {
			border-left: 4px solid #667eea;
			padding-left: 20px;
			color: #666;
			font-style: italic;
		}
	</style>
</head>
<body>
${content}
</body>
</html>
				`], { type: 'text/html;charset=utf-8' });
				
				const url = URL.createObjectURL(blob);
				const a = document.createElement('a');
				a.href = url;
				a.download = `è®¾å¤‡é€‰å‹æ–‡æ¡£_${new Date().toISOString().slice(0, 10)}.html`;
				a.click();
				URL.revokeObjectURL(url);
				
				alert('âœ… HTMLæ–‡ä»¶å·²å¯¼å‡ºï¼');
				console.log('ğŸŒ HTMLæ–‡ä»¶å·²å¯¼å‡º');
			});
			
			// æ¸…ç©ºæŒ‰é’®
			document.getElementById('clearBtn').addEventListener('click', () => {
				if (confirm('ç¡®å®šè¦æ¸…ç©ºæ‰€æœ‰å†…å®¹å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚')) {
					editor.commands.setContent('');
					localStorage.removeItem('wordEditorContent');
					alert('âœ… å†…å®¹å·²æ¸…ç©ºï¼');
					console.log('ğŸ—‘ï¸ å†…å®¹å·²æ¸…ç©º');
				}
			});
		}
		
		// å¯åŠ¨ç¼–è¾‘å™¨
		initEditor();
	</script>
	
	<!-- ç‰ˆæƒä¿¡æ¯ -->
	<div style="position: fixed; bottom: 10px; right: 15px; font-size: 10px; color: white; background: rgba(0,0,0,0.3); padding: 6px 12px; border-radius: 4px; z-index: 100;">
		Wordç¼–è¾‘å™¨ v1.0 | Â© 2025 ZXX
	</div>
</body>
</html>

