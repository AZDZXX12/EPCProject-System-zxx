# ğŸš¨ 404é”™è¯¯ - åç«¯APIä¸å­˜åœ¨

## ğŸ“ å½“å‰é—®é¢˜

```
âŒ https://luckysheet-backend.onrender.com/api/selections/whitelist/
   Status: 404 Not Found
   
åŸå› : åç«¯APIä»£ç å·²å®Œæˆä½†è¿˜åœ¨æœ¬åœ°ï¼Œæ— æ³•æ¨é€åˆ°GitHub
```

---

## âš¡ å¿«é€Ÿè§£å†³æ–¹æ¡ˆï¼ˆ3é€‰1ï¼‰

### æ–¹æ¡ˆ1ï¸âƒ£ï¼šä½¿ç”¨GitHub Desktopï¼ˆæœ€ç®€å•ï¼‰âœ¨

1. **ä¸‹è½½GitHub Desktop**
   - è®¿é—®ï¼šhttps://desktop.github.com/
   - ä¸‹è½½å¹¶å®‰è£…

2. **æ‰“å¼€é¡¹ç›®**
   - å¯åŠ¨GitHub Desktop
   - File â†’ Add Local Repository
   - é€‰æ‹©ï¼š`C:\Users\Administrator\Desktop\Luckysheet-master-2.0.2`

3. **æ¨é€ä»£ç **
   - ç‚¹å‡»å³ä¸Šè§’ "Push origin" æŒ‰é’®
   - ç­‰å¾…å®Œæˆ âœ…

4. **ç­‰å¾…Renderéƒ¨ç½²**
   - 5-10åˆ†é’ŸåAPIè‡ªåŠ¨å¯ç”¨

---

### æ–¹æ¡ˆ2ï¸âƒ£ï¼šä½¿ç”¨VPN/ä»£ç†æ¨é€

å¦‚æœæ‚¨æœ‰VPNæˆ–ä»£ç†ï¼š

```bash
# è®¾ç½®ä»£ç†ï¼ˆä¿®æ”¹ä¸ºæ‚¨çš„ä»£ç†åœ°å€ï¼‰
git config --global http.proxy http://127.0.0.1:7890
git config --global https.proxy http://127.0.0.1:7890

# æ¨é€
cd C:\Users\Administrator\Desktop\Luckysheet-master-2.0.2
git push origin main

# æ¸…é™¤ä»£ç†è®¾ç½®
git config --global --unset http.proxy
git config --global --unset https.proxy
```

---

### æ–¹æ¡ˆ3ï¸âƒ£ï¼šæ‰‹åŠ¨ä¸Šä¼ åˆ°GitHubç½‘é¡µï¼ˆç¨å¤æ‚ï¼‰

#### æ­¥éª¤1ï¼šè®¿é—®GitHubä»“åº“
æ‰“å¼€ï¼šhttps://github.com/azdzxx/luckysheet-selection-system

#### æ­¥éª¤2ï¼šç¼–è¾‘ `models.py`
1. å¯¼èˆªåˆ° `xuanxing/backend/selections/models.py`
2. ç‚¹å‡»ç¼–è¾‘æŒ‰é’®ï¼ˆé“…ç¬”å›¾æ ‡ï¼‰
3. åœ¨æ–‡ä»¶å¼€å¤´æ·»åŠ ï¼š

```python
class Whitelist(models.Model):
    """æ‰‹æœºå·ç™½åå•æ¨¡å‹ - ç”¨äºå­˜å‚¨æˆæƒçš„æ‰‹æœºå·"""
    
    phone = models.CharField(max_length=11, unique=True, verbose_name="æ‰‹æœºå·")
    created_at = models.DateTimeField(default=timezone.now, verbose_name="æ·»åŠ æ—¶é—´")
    updated_at = models.DateTimeField(auto_now=True, verbose_name="æ›´æ–°æ—¶é—´")
    updated_by = models.CharField(max_length=11, blank=True, verbose_name="æ“ä½œäºº")
    
    class Meta:
        db_table = 'phone_whitelist'
        verbose_name = 'ç™½åå•'
        verbose_name_plural = 'ç™½åå•'
        ordering = ['phone']
    
    def __str__(self):
        return self.phone


```

4. åœ¨ `SelectionRecord` æ¨¡å‹çš„ `notes` å­—æ®µåæ·»åŠ ï¼š

```python
    # ç”¨æˆ·æ‰‹æœºå·ï¼ˆç”¨äºå…³è”ç”¨æˆ·ï¼‰
    phone = models.CharField(max_length=11, blank=True, verbose_name="ç”¨æˆ·æ‰‹æœºå·")
```

5. ç‚¹å‡» "Commit changes"

#### æ­¥éª¤3ï¼šç¼–è¾‘ `views.py`
1. å¯¼èˆªåˆ° `xuanxing/backend/selections/views.py`
2. ç‚¹å‡»ç¼–è¾‘æŒ‰é’®
3. ä¿®æ”¹å¯¼å…¥éƒ¨åˆ†ï¼š

```python
from rest_framework.decorators import action, api_view
from .models import SelectionRecord, Whitelist
```

4. åœ¨æ–‡ä»¶æœ«å°¾æ·»åŠ ï¼š

```python
@api_view(['GET', 'POST'])
def whitelist_view(request):
    """ç™½åå•API - è·å–å’Œæ›´æ–°ç™½åå•"""
    
    if request.method == 'GET':
        whitelist = Whitelist.objects.all().values_list('phone', flat=True)
        whitelist_list = list(whitelist)
        
        if not whitelist_list:
            default_admin = '18968563368'
            Whitelist.objects.get_or_create(phone=default_admin)
            whitelist_list = [default_admin]
        
        return Response({'whitelist': whitelist_list})
    
    elif request.method == 'POST':
        whitelist_data = request.data.get('whitelist', [])
        updated_by = request.data.get('updated_by', 'unknown')
        
        if '18968563368' not in whitelist_data:
            whitelist_data.append('18968563368')
        
        Whitelist.objects.exclude(phone__in=whitelist_data).delete()
        
        for phone in whitelist_data:
            Whitelist.objects.update_or_create(
                phone=phone,
                defaults={'updated_by': updated_by}
            )
        
        return Response({
            'message': 'ç™½åå•æ›´æ–°æˆåŠŸ',
            'whitelist': whitelist_data
        })
```

5. ç‚¹å‡» "Commit changes"

#### æ­¥éª¤4ï¼šç¼–è¾‘å…¶ä»–æ–‡ä»¶
ç»§ç»­ç¼–è¾‘ï¼š
- `xuanxing/backend/selections/urls.py`
- `xuanxing/backend/selections/serializers.py`

ï¼ˆå‚è€ƒæœ¬åœ°æ–‡ä»¶å†…å®¹ï¼‰

#### æ­¥éª¤5ï¼šåˆ›å»ºè¿ç§»æ–‡ä»¶
1. ç‚¹å‡» `xuanxing/backend/selections/migrations/` æ–‡ä»¶å¤¹
2. ç‚¹å‡» "Add file" â†’ "Create new file"
3. æ–‡ä»¶åï¼š`0002_whitelist_and_phone_field.py`
4. å†…å®¹å‚è€ƒæœ¬åœ°çš„ `xuanxing/backend/selections/migrations/0002_whitelist_and_phone_field.py`
5. ç‚¹å‡» "Commit new file"

---

## ğŸ¯ æ¨èæ–¹æ¡ˆ

**å¼ºçƒˆæ¨èä½¿ç”¨æ–¹æ¡ˆ1ï¼ˆGitHub Desktopï¼‰**ï¼Œå› ä¸ºï¼š
- âœ… å›¾å½¢ç•Œé¢ï¼Œæ“ä½œç®€å•
- âœ… è‡ªåŠ¨å¤„ç†æ‰€æœ‰æ–‡ä»¶
- âœ… ä¸éœ€è¦æ‰‹åŠ¨å¤åˆ¶ä»£ç 
- âœ… é¿å…äººä¸ºé”™è¯¯

---

## ğŸ“¦ æœ¬åœ°å·²ä¿®æ”¹çš„æ–‡ä»¶æ¸…å•

å¦‚æœæ‚¨é€‰æ‹©æ–¹æ¡ˆ3æ‰‹åŠ¨ä¸Šä¼ ï¼Œéœ€è¦ä¿®æ”¹è¿™äº›æ–‡ä»¶ï¼š

```
xuanxing/backend/selections/
â”œâ”€â”€ models.py          â† æ–°å¢Whitelistæ¨¡å‹
â”œâ”€â”€ views.py           â† æ–°å¢whitelist_viewå‡½æ•°
â”œâ”€â”€ urls.py            â† æ·»åŠ whitelistè·¯ç”±
â”œâ”€â”€ serializers.py     â† æ–°å¢WhitelistSerializer
â””â”€â”€ migrations/
    â””â”€â”€ 0002_whitelist_and_phone_field.py  â† æ–°å»ºæ–‡ä»¶
```

æ‰€æœ‰ä¿®æ”¹åçš„å®Œæ•´æ–‡ä»¶å·²ä¿å­˜åœ¨æœ¬åœ°é¡¹ç›®ä¸­ï¼Œå¯ä»¥ç›´æ¥å¤åˆ¶ã€‚

---

## â±ï¸ éƒ¨ç½²æ—¶é—´çº¿

æ¨é€æˆåŠŸåï¼š

```
0åˆ†é’Ÿ  - GitHubæ¥æ”¶åˆ°æ–°ä»£ç 
1åˆ†é’Ÿ  - Renderæ£€æµ‹åˆ°æ›´æ–°å¹¶å¼€å§‹æ„å»º
3åˆ†é’Ÿ  - å®‰è£…ä¾èµ–
4åˆ†é’Ÿ  - æ‰§è¡Œæ•°æ®åº“è¿ç§» (åˆ›å»ºç™½åå•è¡¨)
5åˆ†é’Ÿ  - å¯åŠ¨æœåŠ¡
6åˆ†é’Ÿ  - âœ… APIå¯ç”¨ï¼
```

éªŒè¯æ–¹å¼ï¼š
```
è®¿é—®ï¼šhttps://luckysheet-backend.onrender.com/api/selections/whitelist/
åº”è¯¥è¿”å›ï¼š{"whitelist": ["18968563368"]}
```

---

## ğŸ” éªŒè¯éƒ¨ç½²æˆåŠŸ

### æµ‹è¯•1ï¼šAPIå“åº”
```bash
# æ‰“å¼€æµè§ˆå™¨è®¿é—®
https://luckysheet-backend.onrender.com/api/selections/whitelist/

# æˆ–ä½¿ç”¨å‘½ä»¤è¡Œ
curl https://luckysheet-backend.onrender.com/api/selections/whitelist/
```

**æœŸæœ›ç»“æœï¼š**
```json
{
  "whitelist": ["18968563368"]
}
```

### æµ‹è¯•2ï¼šå‰ç«¯åŒæ­¥
1. æ‰“å¼€æµè§ˆå™¨Consoleï¼ˆF12ï¼‰
2. åˆ·æ–°ç”¨æˆ·ç®¡ç†é¡µé¢
3. åº”è¯¥çœ‹åˆ°ï¼š
```
ğŸ“¡ æ­£åœ¨ä»äº‘ç«¯åŒæ­¥ç™½åå•...
âœ… ç™½åå•åŒæ­¥æˆåŠŸ: ['18968563368']
```

### æµ‹è¯•3ï¼šè·¨è®¾å¤‡åŠŸèƒ½
1. ç”µè„‘Aï¼šæ·»åŠ ç”¨æˆ· `13800138000`
2. ç”µè„‘Bï¼šåˆ·æ–°é¡µé¢ï¼Œçœ‹åˆ°æ–°ç”¨æˆ· âœ…
3. ç”µè„‘Cï¼šç™»å½•è¯¥å·ç ï¼Œè¯†åˆ«æˆæƒ âœ…

---

## ğŸ†˜ å¦‚æœè¿˜æ˜¯404

### å¯èƒ½åŸå› 1ï¼šRenderæœªéƒ¨ç½²
**è§£å†³ï¼š** ç™»å½•Render Dashboardï¼Œæ‰‹åŠ¨è§¦å‘é‡æ–°éƒ¨ç½²

### å¯èƒ½åŸå› 2ï¼šæ•°æ®åº“è¿ç§»å¤±è´¥
**è§£å†³ï¼š** æŸ¥çœ‹Renderéƒ¨ç½²æ—¥å¿—ï¼Œæœç´¢"migrate"å…³é”®è¯

### å¯èƒ½åŸå› 3ï¼šè·¯ç”±é…ç½®é”™è¯¯
**è§£å†³ï¼š** æ£€æŸ¥ `urls.py` æ˜¯å¦æ­£ç¡®æ·»åŠ äº† `path('whitelist/', ...)`

---

## ğŸ’¡ ä¸´æ—¶è§£å†³æ–¹æ¡ˆ

åœ¨åç«¯APIéƒ¨ç½²å®Œæˆä¹‹å‰ï¼Œç³»ç»Ÿä¼šè‡ªåŠ¨ä½¿ç”¨æœ¬åœ°ç¼“å­˜æ¨¡å¼ï¼š

```javascript
// whitelistSync.js å·²å®ç°é™çº§ç­–ç•¥
âš ï¸ äº‘ç«¯ç™½åå•ä¸å¯ç”¨ï¼Œä½¿ç”¨æœ¬åœ°ç¼“å­˜
```

**é™åˆ¶ï¼š**
- âš ï¸ åªèƒ½åœ¨å•å°ç”µè„‘ç®¡ç†ç”¨æˆ·
- âš ï¸ æ— æ³•è·¨è®¾å¤‡åŒæ­¥
- âš ï¸ æ¯æ¬¡æ·»åŠ ç”¨æˆ·åéœ€è¦é€šçŸ¥å…¶ä»–ç®¡ç†å‘˜

**ä¸€æ—¦åç«¯éƒ¨ç½²å®Œæˆï¼Œç«‹å³è‡ªåŠ¨åˆ‡æ¢åˆ°äº‘ç«¯æ¨¡å¼ï¼**

---

## ğŸ“ éœ€è¦å¸®åŠ©ï¼Ÿ

å¦‚æœé‡åˆ°é—®é¢˜ï¼Œè¯·æä¾›ä»¥ä¸‹ä¿¡æ¯ï¼š

1. **GitHubæ¨é€çŠ¶æ€**
   ```bash
   git status
   git log --oneline -3
   ```

2. **Renderéƒ¨ç½²æ—¥å¿—**
   - ç™»å½• https://dashboard.render.com/
   - ç‚¹å‡»åç«¯æœåŠ¡
   - å¤åˆ¶æœ€å50è¡Œæ—¥å¿—

3. **æµè§ˆå™¨Consoleé”™è¯¯**
   - æ‰“å¼€F12å¼€å‘è€…å·¥å…·
   - æˆªå›¾Consoleå’ŒNetworkæ ‡ç­¾

---

**ä¸‹ä¸€æ­¥ï¼šè¯·é€‰æ‹©ä¸Šè¿°æ–¹æ¡ˆ1ã€2æˆ–3ä¹‹ä¸€æ¨é€ä»£ç åˆ°GitHubï¼Œé—®é¢˜å³å¯è§£å†³ï¼** ğŸš€

