# ✅ 部署检查清单

使用此清单确保所有步骤都已完成。

## 📦 准备阶段

- [ ] 已安装 Git
- [ ] 已在 GitHub 创建仓库（可以是私有仓库）
- [ ] 已将代码推送到 GitHub
  ```bash
  # 或运行：快速推送到GitHub.bat
  git init
  git add .
  git commit -m "初始提交"
  git remote add origin https://github.com/用户名/仓库名.git
  git push -u origin main
  ```

## 🔧 后端部署（Render.com）

### 第1步：创建数据库
- [ ] 访问 https://render.com 并注册
- [ ] 点击 "New +" → "PostgreSQL"
- [ ] 配置：
  - Name: `cable-selector-db`
  - Database: `cable_selector`
  - Plan: **Free**
- [ ] 复制 **Internal Database URL**（类似 `postgresql://...`）
  - 保存到安全的地方 ⬇️
  ```
  数据库URL: _________________________________
  ```

### 第2步：创建Web服务
- [ ] 点击 "New +" → "Web Service"
- [ ] 连接 GitHub 仓库
- [ ] 配置：
  - Name: `cable-selector-backend`（或其他名称）
  - Region: Oregon（或其他区域）
  - Root Directory: `xuanxing/backend`
  - Runtime: **Python 3**
  - Build Command:
    ```bash
    pip install -r requirements.txt && python manage.py collectstatic --no-input && python manage.py migrate && python manage.py load_initial_data
    ```
  - Start Command:
    ```bash
    gunicorn cable_selector.wsgi:application
    ```
  - Plan: **Free**

### 第3步：配置环境变量
- [ ] 添加以下环境变量：
  - `SECRET_KEY`: [点击 Generate 自动生成] ✅
  - `DEBUG`: `False` ✅
  - `DATABASE_URL`: [粘贴第1步的数据库URL] ✅
  - `ALLOWED_HOSTS`: 先留空，部署后填写 ⏳
  - `CORS_ALLOWED_ORIGINS`: 先留空，前端部署后填写 ⏳

### 第4步：部署并测试
- [ ] 点击 "Create Web Service"
- [ ] 等待部署完成（3-5分钟）
- [ ] 记录后端URL ⬇️
  ```
  后端URL: https://__________________.onrender.com
  ```
- [ ] 测试API是否正常：
  ```
  访问：https://你的服务名.onrender.com/api/cables/
  ```
  - [ ] 返回JSON数据 ✅

## 🎨 前端部署（Vercel.com）

### 第1步：导入项目
- [ ] 访问 https://vercel.com 并注册（建议用GitHub登录）
- [ ] 点击 "Add New Project"
- [ ] 选择你的 GitHub 仓库
- [ ] 配置：
  - Project Name: `luckysheet-selection-system`（或其他名称）
  - Framework: **Other**
  - Root Directory: 留空
  - Build Command: 留空
  - Output Directory: `dist-refactored`
  - Install Command: 留空

### 第2步：部署
- [ ] 点击 "Deploy"
- [ ] 等待部署完成（1-2分钟）
- [ ] 记录前端URL ⬇️
  ```
  前端URL: https://__________________.vercel.app
  ```

### 第3步：测试前端
- [ ] 访问前端URL
- [ ] 主页加载正常 ✅
- [ ] 可以打开Excel文件 ✅
- [ ] 离心风机选型功能正常（纯前端） ✅

## 🔗 连接前后端

### 第1步：更新后端配置
- [ ] 回到 Render 后端服务
- [ ] 进入 "Environment" 标签
- [ ] 更新环境变量：
  - `ALLOWED_HOSTS`: 粘贴 Render 的域名（去掉 https://）
    ```
    你的服务名.onrender.com
    ```
  - `CORS_ALLOWED_ORIGINS`: 粘贴 Vercel 的完整URL
    ```
    https://你的项目名.vercel.app
    ```
- [ ] 保存后等待自动重新部署

### 第2步：更新前端API地址（可选）
> 如果需要使用电缆选型功能，才需要此步骤

- [ ] 找到文件：`dist-refactored/cable-selector/assets/index-*.js`
- [ ] 搜索 `localhost:8000` 并替换为 Render 后端URL
  ```javascript
  // 从：
  const API_URL = 'http://localhost:8000/api';
  // 改为：
  const API_URL = 'https://你的服务名.onrender.com/api';
  ```
- [ ] 保存并推送到 GitHub：
  ```bash
  git add .
  git commit -m "更新API地址"
  git push
  ```
- [ ] Vercel 会自动重新部署

## ✅ 最终测试

- [ ] 访问前端：`https://你的项目名.vercel.app`
- [ ] 测试以下功能：
  - [ ] 主页加载 ✅
  - [ ] 打开Excel文件 ✅
  - [ ] 编辑表格 ✅
  - [ ] 保存文件 ✅
  - [ ] 离心风机选型 ✅
  - [ ] 电缆选型（如果已配置后端）✅
  - [ ] PDF导出 ✅

## 🎉 部署完成！

如果所有项目都勾选了，恭喜你部署成功！🎊

---

## 📋 记录你的部署信息

| 项目 | 地址 |
|------|------|
| GitHub 仓库 | https://github.com/________/________ |
| 前端（Vercel） | https://__________________.vercel.app |
| 后端（Render） | https://__________________.onrender.com |
| 数据库（Render） | postgresql://__________________ |

---

## 🔧 后续优化（可选）

- [ ] 设置自定义域名（Vercel和Render都免费支持）
- [ ] 使用 UptimeRobot 监控后端（避免休眠）
- [ ] 添加 Google Analytics 统计
- [ ] 启用 Vercel Analytics（免费）
- [ ] 配置 Sentry 错误追踪（免费tier）

---

## 🆘 遇到问题？

参考 **[部署指南.md](./部署指南.md)** 的 "常见问题" 部分。

或检查：
1. Render 的 Logs 标签（查看后端日志）
2. Vercel 的 Deployment Logs（查看部署日志）
3. 浏览器控制台的 Console 和 Network 标签

