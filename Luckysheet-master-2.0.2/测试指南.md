# 🧪 测试指南

## 📋 测试项目

### 1️⃣ 测试详情面板滚动条

**操作步骤**：
1. 打开应用
2. 查看右侧详情面板
3. 检查是否有滚动条

**期望结果**：
- ✅ 详情面板无滚动条
- ✅ 设备侧边栏无滚动条
- ✅ 界面简洁美观

---

### 2️⃣ 测试Word编辑器窗口

**操作步骤**：
1. 点击左侧工具栏的 "Word编辑器" 按钮
2. 观察弹出的窗口

**期望结果**：
- ✅ 打开一个独立的Electron窗口（不是浏览器标签页）
- ✅ 窗口标题：Word文档编辑器
- ✅ 窗口大小：1200×800
- ✅ 有应用图标
- ✅ 开发模式下自动打开DevTools

**再次点击按钮**：
- ✅ 不会打开新窗口
- ✅ 已有窗口会被聚焦（置顶显示）

**控制台日志**：
```
📝 正在打开Word编辑器...
✅ 已发送打开Word编辑器窗口请求
📝 收到打开子窗口请求: Word文档编辑器
```

---

### 3️⃣ 测试离心风机选型窗口

**操作步骤**：
1. 点击左侧工具栏的 "离心风机选型" 按钮
2. 观察弹出的窗口

**期望结果**：
- ✅ 打开一个独立的Electron窗口
- ✅ 窗口标题：离心风机选型工具
- ✅ 窗口大小：1600×1000
- ✅ 有应用图标

**控制台日志**：
```
🌀 正在打开离心风机选型工具...
✅ 已发送打开风机选型窗口请求
📝 收到打开子窗口请求: 离心风机选型工具
```

---

### 4️⃣ 测试电缆选型工具窗口（重点）

**操作步骤**：
1. 点击左侧工具栏的 "电缆选型" 按钮
2. 观察弹出的窗口

**期望结果**：
- ✅ 打开一个独立的Electron窗口
- ✅ 窗口标题：电缆选型工具
- ✅ 窗口大小：1600×1000
- ✅ React应用正常加载显示
- ✅ **没有"file://协议"警告**
- ✅ 有应用图标

**控制台日志**：
```
⚡ 正在打开电缆选型工具...
✅ 已发送打开电缆选型窗口请求
📝 收到打开子窗口请求: 电缆选型工具
```

**如果出现问题**：
- 检查控制台是否有错误
- 确认HTTP服务器是否启动：`✅ HTTP服务器已启动: http://localhost:8765`
- 确认端口8765没有被占用

---

### 5️⃣ 测试YJV数据表窗口

**操作步骤**：
1. 点击左侧工具栏的 "YJV数据表" 按钮
2. 观察弹出的窗口

**期望结果**：
- ✅ 打开一个独立的Electron窗口
- ✅ 窗口标题：YJV电缆数据表
- ✅ 窗口大小：1600×1000
- ✅ 表格数据正常显示
- ✅ 有应用图标

**控制台日志**：
```
📊 正在打开YJV电缆数据表...
✅ 已发送打开YJV数据表窗口请求
📝 收到打开子窗口请求: YJV电缆数据表
```

---

### 6️⃣ 测试窗口智能管理

**操作步骤**：
1. 点击 "电缆选型" 打开窗口A
2. 最小化窗口A或切换到主窗口
3. 再次点击 "电缆选型" 按钮

**期望结果**：
- ✅ **不会打开新窗口**
- ✅ 窗口A会被聚焦并置顶显示
- ✅ 控制台日志显示：`✅ 已发送打开电缆选型窗口请求`

**测试所有工具**：
- Word编辑器 ✅
- 离心风机选型 ✅
- 电缆选型工具 ✅
- YJV数据表 ✅

---

### 7️⃣ 测试父子窗口关系

**操作步骤**：
1. 打开所有工具窗口（Word、风机、电缆、YJV）
2. 关闭主窗口

**期望结果**：
- ✅ 主窗口关闭时，所有子窗口自动关闭
- ✅ HTTP服务器自动停止
- ✅ 应用完全退出

**控制台日志**：
```
✅ HTTP服务器已关闭
```

---

### 8️⃣ 测试浏览器环境兼容性

**操作步骤**：
1. 停止Electron应用
2. 启动HTTP服务器：`cd dist-refactored && python -m http.server 8000`
3. 在浏览器中访问：`http://localhost:8000/index.html`
4. 点击各个工具按钮

**期望结果**：
- ✅ 在浏览器中以新标签页方式打开
- ✅ 功能正常工作
- ✅ Electron和浏览器环境都兼容

---

## 🐛 常见问题排查

### 问题1：点击按钮没反应

**排查步骤**：
1. 打开开发者工具（F12）
2. 查看Console是否有错误
3. 检查是否有日志输出

**可能原因**：
- IPC通信失败
- window.require未定义
- 按钮事件未绑定

**解决方法**：
- 重启应用
- 检查main.js是否正确加载
- 确认wordEditor.js已加载

### 问题2：窗口打开但内容空白

**排查步骤**：
1. 在子窗口中打开开发者工具（F12）
2. 查看Console错误
3. 查看Network标签，检查资源是否加载

**可能原因**：
- HTTP服务器未启动
- 资源路径错误
- 端口被占用

**解决方法**：
```bash
# 检查端口占用
netstat -ano | findstr :8765

# 如果被占用，杀掉进程或修改端口
```

### 问题3：重复打开多个窗口

**排查步骤**：
1. 检查控制台日志
2. 查看childWindows对象

**可能原因**：
- 窗口管理逻辑失效
- key值冲突

**解决方法**：
- 重启应用
- 检查main.js中的createChildWindow函数

### 问题4：详情面板仍有滚动条

**排查步骤**：
1. 打开开发者工具（F12）
2. 检查Elements标签
3. 查看.device-detail-panel的样式

**可能原因**：
- CSS未生效
- 浏览器缓存

**解决方法**：
```
Ctrl+Shift+R (强制刷新，清除缓存)
```

---

## ✅ 成功标准

### 所有测试通过标准：

1. ✅ 详情面板无滚动条
2. ✅ 所有工具都以独立Electron窗口打开
3. ✅ 窗口有正确的标题和图标
4. ✅ 重复点击会聚焦已有窗口
5. ✅ 主窗口关闭时子窗口自动关闭
6. ✅ 电缆选型工具（React）正常运行
7. ✅ 无"file://协议"警告
8. ✅ 开发模式下子窗口自动打开DevTools
9. ✅ 控制台日志正常输出
10. ✅ HTTP服务器自动启动和关闭

---

## 📊 测试报告模板

```
测试日期：2025-10-15
测试版本：v1.0.2
测试环境：Windows 10, Electron 22.3.27

【详情面板滚动条】
- [ ] 详情面板无滚动条
- [ ] 设备侧边栏无滚动条

【Word编辑器】
- [ ] 独立窗口打开
- [ ] 窗口标题正确
- [ ] 重复点击聚焦

【离心风机选型】
- [ ] 独立窗口打开
- [ ] 窗口标题正确
- [ ] 重复点击聚焦

【电缆选型工具】
- [ ] 独立窗口打开
- [ ] React应用正常
- [ ] 无协议警告
- [ ] 重复点击聚焦

【YJV数据表】
- [ ] 独立窗口打开
- [ ] 表格数据显示
- [ ] 重复点击聚焦

【窗口管理】
- [ ] 主窗口关闭时子窗口自动关闭
- [ ] HTTP服务器自动停止

【浏览器兼容】
- [ ] 浏览器环境正常打开
- [ ] 功能正常使用

测试结果：[ ] 全部通过 [ ] 部分通过 [ ] 未通过

备注：
```

---

**祝测试顺利！** 🎉

