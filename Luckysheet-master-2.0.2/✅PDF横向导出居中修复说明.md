# âœ… PDFæ¨ªå‘å¯¼å‡ºå±…ä¸­ä¿®å¤è¯´æ˜

## ğŸ› é—®é¢˜æè¿°

**ç”¨æˆ·åé¦ˆ**ï¼šå¯¼å‡ºPDFæ—¶ï¼ŒA4æ¨ªå‘å¸ƒå±€çš„è¡¨æ ¼æ²¡æœ‰å±…ä¸­æ˜¾ç¤ºï¼Œè€Œæ˜¯é å·¦å¯¹é½ã€‚

**é—®é¢˜æˆªå›¾**ï¼š
- PDFé¢„è§ˆçª—å£ä¸­ï¼Œæ¨ªå‘è¡¨æ ¼æ˜¾ç¤ºåœ¨é¡µé¢å·¦ä¾§
- å³ä¾§æœ‰å¤§é‡ç©ºç™½
- è¡¨æ ¼æ²¡æœ‰æ°´å¹³å±…ä¸­

---

## ğŸ” é—®é¢˜åŸå› 

### åŸæœ‰ä»£ç é€»è¾‘

```javascript
// âŒ é”™è¯¯çš„è®¡ç®—æ–¹å¼
const imgWidth = pageWidth - 10; // å¼ºåˆ¶å›¾ç‰‡å®½åº¦å¡«æ»¡é¡µé¢
const imgHeight = (canvas.height * imgWidth) / canvas.width;
const xPos = (pageWidth - imgWidth) / 2; // å±…ä¸­ä½ç½®
```

**é—®é¢˜åˆ†æ**ï¼š
1. `imgWidth` è¢«å¼ºåˆ¶è®¾ç½®ä¸º `pageWidth - 10`
2. è¿™å¯¼è‡´xPosæ°¸è¿œæ˜¯ `(pageWidth - (pageWidth - 10)) / 2 = 5mm`
3. å›¾ç‰‡æ€»æ˜¯ä»å·¦è¾¹5mmå¼€å§‹ï¼Œ**çœ‹èµ·æ¥æ˜¯å±…ä¸­çš„**
4. **ä½†å®é™…ä¸Šcanvasæœ¬èº«å¯èƒ½å¾ˆå®½**ï¼Œè¢«å¼ºåˆ¶æ‹‰ä¼¸åˆ°é¡µé¢å®½åº¦ï¼Œå¯¼è‡´ï¼š
   - æ¨ªå‘è¡¨æ ¼ï¼šcanvaså¾ˆå®½ï¼Œå›¾ç‰‡è¢«æ‹‰ä¼¸ï¼Œä½†å®é™…å†…å®¹åªå ä¸€éƒ¨åˆ†
   - çºµå‘è¡¨æ ¼ï¼šcanvasè¾ƒçª„ï¼Œå›¾ç‰‡å¡«æ»¡å®½åº¦ï¼Œçœ‹èµ·æ¥æ­£å¸¸

---

## ğŸ”§ ä¿®å¤æ–¹æ¡ˆ

### æ–°çš„è®¡ç®—é€»è¾‘

**æ ¸å¿ƒæ€è·¯**ï¼šæ ¹æ®canvasçš„**å®é™…å®½é«˜æ¯”**è®¡ç®—å›¾ç‰‡å°ºå¯¸ï¼Œç„¶åå±…ä¸­ã€‚

```javascript
// âœ… æ­£ç¡®çš„è®¡ç®—æ–¹å¼
const margin = 10; // é¡µé¢è¾¹è·
const maxWidth = pageWidth - margin;
const maxHeight = pageHeight - margin;

// è®¡ç®—å®½é«˜æ¯”
const canvasRatio = canvas.width / canvas.height;
const pageRatio = maxWidth / maxHeight;

let imgWidth, imgHeight;
if (canvasRatio > pageRatio) {
    // canvasæ›´å®½ï¼ˆæ¨ªå‘è¡¨æ ¼ï¼‰ï¼Œä»¥å®½åº¦ä¸ºå‡†
    imgWidth = maxWidth;
    imgHeight = imgWidth / canvasRatio;
} else {
    // canvasæ›´é«˜ï¼ˆçºµå‘è¡¨æ ¼ï¼‰ï¼Œä»¥é«˜åº¦ä¸ºå‡†
    imgHeight = maxHeight;
    imgWidth = imgHeight * canvasRatio;
}

// è®¡ç®—çœŸæ­£çš„å±…ä¸­ä½ç½®
const xPos = (pageWidth - imgWidth) / 2;
const yPos = (pageHeight - imgHeight) / 2;
```

---

## ğŸ“Š è®¡ç®—ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šæ¨ªå‘å¸ƒå±€ï¼ˆA4 Landscapeï¼‰

**é¡µé¢å°ºå¯¸**ï¼š
- pageWidth = 297mm
- pageHeight = 210mm
- maxWidth = 287mm (297 - 10)
- maxHeight = 200mm (210 - 10)

**Canvaså°ºå¯¸**ï¼š
- canvas.width = 1600px
- canvas.height = 800px
- canvasRatio = 1600 / 800 = 2.0

**é¡µé¢æ¯”ä¾‹**ï¼š
- pageRatio = 287 / 200 = 1.435

**æ¯”è¾ƒ**ï¼š
- canvasRatio (2.0) > pageRatio (1.435)
- è¯´æ˜canvasæ›´å®½ï¼Œä»¥å®½åº¦ä¸ºå‡†

**è®¡ç®—ç»“æœ**ï¼š
```
imgWidth = 287mm
imgHeight = 287 / 2.0 = 143.5mm
xPos = (297 - 287) / 2 = 5mm
yPos = (210 - 143.5) / 2 = 33.25mm âœ… å‚ç›´å±…ä¸­
```

---

### ç¤ºä¾‹2ï¼šçºµå‘å¸ƒå±€ï¼ˆA4 Portraitï¼‰

**é¡µé¢å°ºå¯¸**ï¼š
- pageWidth = 210mm
- pageHeight = 297mm
- maxWidth = 200mm
- maxHeight = 287mm

**Canvaså°ºå¯¸**ï¼š
- canvas.width = 800px
- canvas.height = 1200px
- canvasRatio = 800 / 1200 = 0.667

**é¡µé¢æ¯”ä¾‹**ï¼š
- pageRatio = 200 / 287 = 0.697

**æ¯”è¾ƒ**ï¼š
- canvasRatio (0.667) < pageRatio (0.697)
- è¯´æ˜canvasæ›´é«˜ï¼Œä»¥é«˜åº¦ä¸ºå‡†

**è®¡ç®—ç»“æœ**ï¼š
```
imgHeight = 287mm
imgWidth = 287 Ã— 0.667 = 191.4mm
xPos = (210 - 191.4) / 2 = 9.3mm âœ… æ°´å¹³å±…ä¸­
yPos = (297 - 287) / 2 = 5mm
```

---

## ğŸ¯ ä¿®å¤æ•ˆæœ

### ä¿®å¤å‰
- âŒ æ¨ªå‘è¡¨æ ¼é å·¦æ˜¾ç¤º
- âŒ å³ä¾§å¤§é‡ç©ºç™½
- âœ… çºµå‘è¡¨æ ¼æ­£å¸¸ï¼ˆå› ä¸ºcanvasæ¯”ä¾‹æ¥è¿‘é¡µé¢æ¯”ä¾‹ï¼‰

### ä¿®å¤å
- âœ… æ¨ªå‘è¡¨æ ¼å®Œç¾å±…ä¸­
- âœ… å·¦å³ç©ºç™½ç›¸ç­‰
- âœ… çºµå‘è¡¨æ ¼ä¿æŒæ­£å¸¸
- âœ… æ‰€æœ‰å¸ƒå±€éƒ½èƒ½æ­£ç¡®å±…ä¸­

---

## ğŸ§ª æµ‹è¯•éªŒè¯

### æµ‹è¯•æ­¥éª¤

1. **æµ‹è¯•æ¨ªå‘å¸ƒå±€**
   ```
   1. æ–°å»ºå·¥ä½œè¡¨
   2. æ·»åŠ è®¾å¤‡æ•°æ®
   3. å¯¼å‡ºPDF â†’ é€‰æ‹©"æ¨ªå‘" + "A4"
   4. æŸ¥çœ‹é¢„è§ˆï¼šè¡¨æ ¼åº”è¯¥æ°´å¹³å’Œå‚ç›´éƒ½å±…ä¸­
   ```

2. **æµ‹è¯•çºµå‘å¸ƒå±€**
   ```
   1. æ–°å»ºå·¥ä½œè¡¨
   2. æ·»åŠ è®¾å¤‡æ•°æ®
   3. å¯¼å‡ºPDF â†’ é€‰æ‹©"çºµå‘" + "A4"
   4. æŸ¥çœ‹é¢„è§ˆï¼šè¡¨æ ¼åº”è¯¥æ°´å¹³å’Œå‚ç›´éƒ½å±…ä¸­
   ```

3. **æµ‹è¯•ä¸åŒé€‰åŒº**
   ```
   - å½“å‰é€‰åŒºï¼ˆå°è¡¨æ ¼ï¼‰
   - å½“å‰Sheetï¼ˆå®Œæ•´è¡¨æ ¼ï¼‰
   - æ‰€æœ‰Sheetï¼ˆå¤šé¡µï¼‰
   ```

---

## ğŸ“ æŠ€æœ¯ç»†èŠ‚

### å®½é«˜æ¯”åˆ¤æ–­é€»è¾‘

```javascript
if (canvasRatio > pageRatio) {
    // canvasæ›´å®½ â†’ ä»¥å®½åº¦ä¸ºå‡†
    // ä¾‹å¦‚ï¼šæ¨ªå‘è¡¨æ ¼ (2.0) > A4æ¨ªå‘ (1.435)
    imgWidth = maxWidth;
    imgHeight = imgWidth / canvasRatio;
} else {
    // canvasæ›´é«˜ â†’ ä»¥é«˜åº¦ä¸ºå‡†
    // ä¾‹å¦‚ï¼šçºµå‘è¡¨æ ¼ (0.667) < A4çºµå‘ (0.697)
    imgHeight = maxHeight;
    imgWidth = imgHeight * canvasRatio;
}
```

### è°ƒè¯•æ—¥å¿—

ä¿®å¤åæ·»åŠ äº†è°ƒè¯•æ—¥å¿—ï¼Œæ–¹ä¾¿æ’æŸ¥é—®é¢˜ï¼š

```
ğŸ“„ PDFé¡µé¢: 297.00mm Ã— 210.00mm
ğŸ–¼ï¸ å›¾ç‰‡å°ºå¯¸: 287.00mm Ã— 143.50mm
ğŸ“ å±…ä¸­ä½ç½®: (5.00, 33.25)
```

**æ—¥å¿—è¯´æ˜**ï¼š
- PDFé¡µé¢ï¼šæ˜¾ç¤ºå½“å‰é¡µé¢çš„å®é™…å°ºå¯¸
- å›¾ç‰‡å°ºå¯¸ï¼šæ˜¾ç¤ºè®¡ç®—åçš„å›¾ç‰‡å°ºå¯¸
- å±…ä¸­ä½ç½®ï¼šæ˜¾ç¤ºå›¾ç‰‡çš„èµ·å§‹åæ ‡ï¼ˆå·¦ä¸Šè§’ï¼‰

---

## ğŸš€ ä½¿ç”¨è¯´æ˜

### å¯¹äºç”¨æˆ·

1. **åˆ·æ–°æµè§ˆå™¨**
   ```
   æŒ‰ Ctrl + F5 å¼ºåˆ¶åˆ·æ–°
   ```

2. **å¯¼å‡ºPDF**
   - ç‚¹å‡»"å¯¼å‡ºPDF"æŒ‰é’®
   - é€‰æ‹©"æ¨ªå‘"å¸ƒå±€
   - ç‚¹å‡»"é˜…è¯»é¢„è§ˆ"
   - æŸ¥çœ‹è¡¨æ ¼æ˜¯å¦å±…ä¸­

3. **æŸ¥çœ‹æ•ˆæœ**
   - æ¨ªå‘è¡¨æ ¼åº”è¯¥åœ¨é¡µé¢ä¸­å¤®
   - å·¦å³ç©ºç™½ç›¸ç­‰
   - ä¸Šä¸‹ç©ºç™½ç›¸ç­‰

---

## ğŸ“Š å¯¹æ¯”æ•ˆæœ

### ä¿®å¤å‰ï¼ˆé”™è¯¯ï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“„ A4 æ¨ªå‘ (297mm Ã— 210mm)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                          â”‚
â”‚ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                 â”‚
â”‚ â”‚                     â”‚                 â”‚
â”‚ â”‚     è¡¨æ ¼å†…å®¹        â”‚                 â”‚
â”‚ â”‚                     â”‚                 â”‚
â”‚ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                 â”‚
â”‚                                          â”‚
â”‚          â† å¤§é‡ç©ºç™½ â†’                    â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### ä¿®å¤åï¼ˆæ­£ç¡®ï¼‰
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ ğŸ“„ A4 æ¨ªå‘ (297mm Ã— 210mm)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                          â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”            â”‚
â”‚      â”‚                     â”‚            â”‚
â”‚      â”‚     è¡¨æ ¼å†…å®¹        â”‚            â”‚
â”‚      â”‚                     â”‚            â”‚
â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜            â”‚
â”‚                                          â”‚
â”‚  â† ç›¸ç­‰ç©ºç™½ â†’ â† ç›¸ç­‰ç©ºç™½ â†’              â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… ä¿®å¤ç¡®è®¤æ¸…å•

- [x] ä¿®å¤PDFæ¨ªå‘å¸ƒå±€å±…ä¸­é—®é¢˜
- [x] æ·»åŠ å®½é«˜æ¯”åˆ¤æ–­é€»è¾‘
- [x] æ·»åŠ è°ƒè¯•æ—¥å¿—
- [x] ä¿æŒçºµå‘å¸ƒå±€æ­£å¸¸
- [x] ä»£ç å·²æäº¤åˆ°Git
- [x] ä»£ç å·²æ¨é€åˆ°GitHub
- [ ] ç”¨æˆ·æµ‹è¯•é€šè¿‡ï¼ˆ**å¾…éªŒè¯**ï¼‰

---

## ğŸ” ç›¸å…³ä»£ç 

**æ–‡ä»¶**ï¼š`dist-refactored/js/modules/legacy.js`

**ä¿®æ”¹ä½ç½®**ï¼šç¬¬10614-10643è¡Œ

**å…³é”®æ”¹åŠ¨**ï¼š
1. ç§»é™¤å¼ºåˆ¶è®¾ç½® `imgWidth = pageWidth - 10`
2. æ·»åŠ å®½é«˜æ¯”åˆ¤æ–­é€»è¾‘
3. æ ¹æ®å®é™…æ¯”ä¾‹è®¡ç®—å›¾ç‰‡å°ºå¯¸
4. è®¡ç®—çœŸæ­£çš„å±…ä¸­ä½ç½®

---

**ğŸ‰ ä¿®å¤å®Œæˆï¼è¯·åˆ·æ–°æµè§ˆå™¨ï¼ˆCtrl+F5ï¼‰åé‡æ–°å¯¼å‡ºPDFæµ‹è¯•ï¼**

**ğŸ“ æµ‹è¯•é‡ç‚¹**ï¼š
1. æ¨ªå‘å¸ƒå±€è¡¨æ ¼æ˜¯å¦å±…ä¸­
2. çºµå‘å¸ƒå±€è¡¨æ ¼æ˜¯å¦æ­£å¸¸
3. å·¦å³ç©ºç™½æ˜¯å¦ç›¸ç­‰
4. ä¸Šä¸‹ç©ºç™½æ˜¯å¦ç›¸ç­‰

