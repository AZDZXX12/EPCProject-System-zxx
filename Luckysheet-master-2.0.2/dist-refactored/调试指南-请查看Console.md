# 调试指南 - 请查看Console输出

## 🔍 问题排查

您报告页码显示乱码，水印没有显示。我添加了详细的调试日志来定位问题。

---

## 📋 测试步骤（必须按顺序执行）

### 步骤1：完全清除缓存

**非常重要！** 旧的JS文件可能被缓存了。

**方法1（推荐）**：强制刷新
```
按住 Ctrl + Shift + R
或
按住 Ctrl + F5
```

**方法2**：清除缓存
1. 按 `F12` 打开开发者工具
2. 右键点击刷新按钮
3. 选择"清空缓存并硬性重新加载"

### 步骤2：打开Console

1. 按 `F12` 打开开发者工具
2. 切换到 **Console** 标签（控制台）
3. 清空之前的日志（点击🚫图标）

### 步骤3：导出PDF

1. 点击 **"导出PDF"** 按钮
2. **立即查看Console输出**（不要关闭对话框）

---

## 📊 应该看到的Console输出

### ✅ 正常情况（应该显示）

```
🎯 设置水印默认值...
📊 更新PDF配置...
💧 pdfConfig.enableWatermark: true
📝 pdfConfig.watermarkText: "泽国化机"
🔢 pdfConfig.watermarkOpacity: 0.2
📐 pdfConfig.watermarkDensity: 9
📄 设置页码 1: 1 / 3
📄 设置页码 2: 2 / 3
📄 设置页码 3: 3 / 3
🔍 检查水印条件: {enableWatermark: true, watermarkText: "泽国化机", shouldAdd: true}
💧 添加水印到预览...
```

**如果看到以上输出**：
- ✅ 代码正确执行
- ✅ 页码应该显示 `1 / 3` 格式
- ✅ 水印应该显示

### ❌ 异常情况1：没有任何日志

**可能原因**：
- 浏览器缓存了旧的JS文件
- 文件没有加载

**解决方案**：
1. 完全关闭浏览器
2. 重新启动浏览器
3. 访问 `http://localhost:8000/index.html`
4. 强制刷新（Ctrl+Shift+R）

### ❌ 异常情况2：水印文字为空

```
⚠️ 水印未添加！原因: {enabled: true, hasText: false}
```

**可能原因**：
- `watermarkText` 输入框的值被清空
- updatePdfConfig() 读取失败

**解决方案**：
请截图Console输出给我看。

### ❌ 异常情况3：页码显示乱码

```
📄 设置页码 1: "1 / 3"
```

**但预览中显示乱码**

**可能原因**：
- 字体问题
- 浏览器渲染问题
- 字符编码问题

**解决方案**：
请截图Console输出和预览页面给我看。

---

## 🎯 请执行并报告

### 您需要做的：

1. ✅ **完全清除缓存**（强制刷新）
2. ✅ **打开Console**（F12 → Console）
3. ✅ **点击"导出PDF"**
4. ✅ **查看Console输出**

### 请告诉我：

1. **Console显示了什么？**
   - 复制粘贴完整的输出
   - 或截图Console

2. **预览页面显示什么？**
   - 页码显示什么？
   - 有没有看到水印？
   - 截图预览页面

3. **对话框中的设置**：
   - "启用水印"是否勾选？
   - 水印文字框显示什么？
   - 透明度显示什么？
   - 密度选择了什么？
   - 截图对话框

---

## 💡 常见问题

### Q1：我看不到任何emoji图标（🎯💧📊等）

**A**：这很正常，重要的是看文字内容，不是emoji。

### Q2：Console在哪里？

**A**：
1. 按F12
2. 顶部有几个标签：Elements、Console、Sources...
3. 点击 **Console** 标签

### Q3：我看到很多其他日志怎么办？

**A**：
1. 清空Console（点击🚫图标）
2. 再次点击"导出PDF"
3. 只看新的输出

### Q4：页码还是显示 `第 1 页 / 共 3 页`

**A**：
- 这说明缓存没清除
- 请完全关闭浏览器重试
- 或者尝试隐私/无痕模式

---

## 🚀 预期结果

### 如果一切正常：

**Console**：
```
✅ 所有日志都显示正确的值
✅ watermarkText: "泽国化机"
✅ 页码: "1 / 3" 格式
```

**预览页面**：
```
✅ 页码显示: 1 / 3（数字格式）
✅ 水印显示: 9个"泽国化机"（3x3网格）
✅ 水印半透明（20%）
```

**对话框**：
```
✅ 启用水印：已勾选
✅ 水印文字：泽国化机
✅ 透明度：0.2
✅ 密度：适中（9个）
```

---

## 📸 需要的截图

请提供以下3张截图：

1. **Console输出**（F12 → Console标签）
2. **PDF预览页面**（显示页码和水印的部分）
3. **PDF导出对话框**（显示水印设置的部分）

有了这些信息，我就能准确定位问题！

---

**重要提示**：
- 一定要先 **强制刷新** (Ctrl+Shift+R)
- 一定要 **打开Console** 查看输出
- 一定要 **截图** 告诉我看到了什么

谢谢配合！🙏

