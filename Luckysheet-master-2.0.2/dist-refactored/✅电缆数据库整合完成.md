# ✅ 电缆数据库整合完成

## 📊 数据来源

电缆选型页面现已整合**Excel数据库中的YJV工作表数据**

- **Excel文件**：`数据库.xlsx`
- **工作表**：YJV
- **数据标准**：GB/T 12706-2020 国家标准
- **生成文件**：`dist-refactored/yjv_cable_data.js`

---

## 🔢 数据统计

### 总规格数：**81种**

### 按芯数分类：
- **1芯电缆**：17种规格（1.5-400mm²）
- **2芯电缆**：16种规格
- **3芯电缆**：16种规格
- **4芯电缆**：16种规格
- **5芯电缆**：8种规格
- **其他多芯**：8种规格

---

## 📋 数据字段说明

每条电缆数据包含以下字段：

| 字段 | 说明 | 单位 | 示例 |
|------|------|------|------|
| `type` | 电缆类型 | - | "YJV" |
| `cores` | 芯数 | 芯 | 3 |
| `crossSection` | 导体标称截面 | mm² | 25.0 |
| `ratedCurrent` | 额定载流量（空气中） | A | 101 |
| `currentBuried` | 载流量（直埋） | A | 120 |
| `resistance` | 导体直流电阻 | Ω/km | 0.727 |
| `reactance` | 电抗值 | Ω/km | 0.08 |
| `insulationThickness` | 绝缘厚度 | mm | 0.9 |
| `sheathThickness` | 护套厚度 | mm | 1.5 |
| `outerDiameter` | 电缆近似外径 | mm | 27.0 |
| `weight` | 电缆近似重量 | kg/m | 1.295 |
| `price` | 参考价格（估算） | 元/m | 108.5 |
| `standard` | 执行标准 | - | "GB/T 12706" |

---

## 🔧 技术实现

### 1. 数据提取脚本

使用Python + openpyxl提取Excel数据：

```bash
# 安装依赖
python -m pip install openpyxl

# 运行提取脚本
python parse_yjv_to_js.py
```

**生成文件**：
- `dist-refactored/yjv_cable_data.js` - JavaScript格式的电缆数据库

### 2. 页面集成

在 `cable-selector.html` 中集成：

```html
<!-- 引入Excel数据库中的YJV电缆数据 -->
<script src="./yjv_cable_data.js"></script>
```

```javascript
// 使用Excel数据库中的YJV电缆数据（从yjv_cable_data.js加载）
const CABLE_SPECS = typeof YJV_CABLE_DATABASE !== 'undefined' ? YJV_CABLE_DATABASE : [
    // 内置备用数据...
];
```

### 3. 验证方法

打开电缆选型页面，查看浏览器控制台：

```
================================================================================
⚡ 电缆选型工具已加载
📊 电缆数据来源: Excel数据库.xlsx (YJV工作表)
📦 电缆规格数量: 81 种
📈 按芯数统计:
   1芯: 17种规格
   2芯: 16种规格
   3芯: 16种规格
   4芯: 16种规格
   5芯: 8种规格
================================================================================
```

---

## 🧪 测试案例

### 测试1：三芯电缆选型

**输入参数**：
- 额定电压：380V
- 负载电流：100A
- 电缆长度：50m
- 芯数：**3芯**

**期望结果**：
- 应显示3芯电缆（从Excel数据库）
- 推荐规格：YJV 3×35mm² 或更大
- 载流量：≥100A（经温度和敷设方式校正后）

### 测试2：单芯大规格电缆

**输入参数**：
- 额定电压：380V
- 负载电流：400A
- 电缆长度：100m
- 芯数：**1芯**

**期望结果**：
- 应显示1芯电缆（从Excel数据库）
- 推荐规格：YJV 1×240mm² 或更大

---

## 📝 数据更新流程

当Excel数据库更新时，重新运行提取脚本：

```bash
# 1. 确保数据库.xlsx已更新
# 2. 运行提取脚本
python parse_yjv_to_js.py

# 3. 生成的yjv_cable_data.js会自动更新
# 4. 刷新浏览器页面即可使用新数据
```

---

## ⚠️ 注意事项

1. **数据完整性**：
   - Excel工作表必须保持原有格式
   - 表头位置固定（第1-4行）
   - 每种芯数的标题行格式："YJV ... X芯"

2. **价格估算**：
   - 当前价格为估算值（截面积 × 2.5）
   - 如需准确价格，请在Excel中添加价格列

3. **电抗值**：
   - 默认使用固定值 0.08 Ω/km
   - 如需精确值，可在Excel中添加电抗列

4. **备用数据**：
   - 如果`yjv_cable_data.js`加载失败
   - 系统会自动使用内置的默认数据（32种规格）

---

## 🎉 优势

相比手动编码数据：

✅ **数据准确性高** - 直接从标准Excel表格提取  
✅ **易于维护** - 只需更新Excel文件  
✅ **数据完整** - 包含81种规格，覆盖1-5芯  
✅ **符合国标** - 严格遵循GB/T 12706-2020标准  
✅ **自动同步** - 修改Excel后重新运行脚本即可更新  

---

**整合完成时间**：2025年10月14日  
**数据来源**：数据库.xlsx -> YJV工作表  
**数据规格数**：81种  
**执行标准**：GB/T 12706-2020

