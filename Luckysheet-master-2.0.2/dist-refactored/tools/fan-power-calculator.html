<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é£æœºåŠŸç‡è®¡ç®— - è®¾å¤‡å‚æ•°é€‰å‹ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="../css/tool-common.css">
</head>
<body>
    <div class="tool-container">
        <div class="tool-header">
            <button class="back-btn" onclick="goBack()">â† è¿”å›</button>
            <h1>ğŸ’¨ é£æœºåŠŸç‡è®¡ç®—</h1>
            <p class="subtitle">æ ¹æ®é£é‡å’Œå‹åŠ›è®¡ç®—é£æœºåŠŸç‡</p>
        </div>

        <div class="tool-content">
            <div class="input-section">
                <div class="input-group">
                    <label for="airflow">é£é‡ (mÂ³/h)</label>
                    <input type="number" id="airflow" placeholder="è¯·è¾“å…¥é£é‡" step="100" value="">
                </div>

                <div class="input-group">
                    <label for="pressure">å…¨å‹ (Pa)</label>
                    <input type="number" id="pressure" placeholder="è¯·è¾“å…¥å…¨å‹" step="10" value="">
                </div>

                <div class="input-group">
                    <label for="efficiency">é£æœºæ•ˆç‡ (%)</label>
                    <input type="number" id="efficiency" placeholder="ä¸€èˆ¬70-85%" value="75" step="1" min="50" max="95">
                </div>

                <div class="input-group">
                    <label for="fanType">é£æœºç±»å‹</label>
                    <select id="fanType">
                        <option value="centrifugal" selected>ç¦»å¿ƒé£æœº</option>
                        <option value="axial">è½´æµé£æœº</option>
                        <option value="mixed">æ··æµé£æœº</option>
                    </select>
                </div>

                <div class="input-group">
                    <label for="motorType">ç”µæœºç±»å‹</label>
                    <select id="motorType">
                        <option value="normal" selected>æ™®é€šç”µæœº</option>
                        <option value="frequency">å˜é¢‘ç”µæœº</option>
                        <option value="explosion">é˜²çˆ†ç”µæœº</option>
                    </select>
                </div>

                <button class="calc-btn" onclick="calculate()">âš¡ è®¡ç®—åŠŸç‡</button>
            </div>

            <div class="result-section" id="resultSection" style="display: none;">
                <h3>ğŸ“Š è®¡ç®—ç»“æœ</h3>
                <div class="result-item">
                    <span class="result-label">è½´åŠŸç‡ï¼š</span>
                    <span class="result-value" id="shaftPower">-</span>
                    <span class="result-unit">kW</span>
                </div>
                <div class="result-item">
                    <span class="result-label">é…ç”¨åŠŸç‡ï¼š</span>
                    <span class="result-value" id="motorPower">-</span>
                    <span class="result-unit">kW</span>
                </div>
                <div class="result-item">
                    <span class="result-label">æ¨èå‹å·ï¼š</span>
                    <span class="result-value" id="motorModel" style="font-size: 18px;">-</span>
                </div>
                <div class="result-item">
                    <span class="result-label">ä¼ åŠ¨æ•ˆç‡ï¼š</span>
                    <span class="result-value" id="transmission">-</span>
                    <span class="result-unit">%</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ£€æŸ¥ç™»å½•çŠ¶æ€
        (function() {
            const sessionInfo = sessionStorage.getItem('currentSession');
            if (!sessionInfo) {
                window.location.href = '../login.html';
            }
        })();

        function calculate() {
            const airflow = parseFloat(document.getElementById('airflow').value);
            const pressure = parseFloat(document.getElementById('pressure').value);
            const efficiency = parseFloat(document.getElementById('efficiency').value);
            const fanType = document.getElementById('fanType').value;
            const motorType = document.getElementById('motorType').value;

            // éªŒè¯è¾“å…¥
            if (!airflow || airflow <= 0) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„é£é‡');
                return;
            }
            if (!pressure || pressure <= 0) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„å…¨å‹');
                return;
            }
            if (!efficiency || efficiency < 50 || efficiency > 95) {
                alert('é£æœºæ•ˆç‡ä¸€èˆ¬åœ¨50-95%ä¹‹é—´');
                return;
            }

            // è®¡ç®—è½´åŠŸç‡
            // P = (Q Ã— P) / (3600 Ã— Î·)
            // Q: é£é‡ mÂ³/h, P: å…¨å‹ Pa, Î·: æ•ˆç‡
            const shaftPower = (airflow * pressure) / (3600 * (efficiency / 100));

            // ä¼ åŠ¨æ•ˆç‡ç³»æ•°
            let transmissionEff = 0.95; // ç›´è”
            if (fanType === 'centrifugal') {
                transmissionEff = 0.92; // çš®å¸¦ä¼ åŠ¨
            }

            // å®‰å…¨ç³»æ•°
            let safetyFactor = 1.15;
            if (motorType === 'frequency') {
                safetyFactor = 1.10; // å˜é¢‘ç•¥ä½
            } else if (motorType === 'explosion') {
                safetyFactor = 1.20; // é˜²çˆ†ç•¥é«˜
            }

            // é…ç”¨ç”µæœºåŠŸç‡
            const motorPower = shaftPower / transmissionEff * safetyFactor;

            // é€‰æ‹©æ ‡å‡†ç”µæœºå‹å·
            const standardPowers = [0.75, 1.1, 1.5, 2.2, 3, 4, 5.5, 7.5, 11, 15, 18.5, 22, 30, 37, 45, 55, 75, 90, 110, 132, 160, 200, 250, 315];
            const selectedPower = standardPowers.find(p => p >= motorPower) || standardPowers[standardPowers.length - 1];

            // ç”Ÿæˆå‹å·
            let motorModel = '';
            if (motorType === 'normal') {
                motorModel = `Y${selectedPower}kW-4P`;
            } else if (motorType === 'frequency') {
                motorModel = `YVP${selectedPower}kW-4P`;
            } else {
                motorModel = `YB3-${selectedPower}kW-4P`;
            }

            // æ˜¾ç¤ºç»“æœ
            document.getElementById('shaftPower').textContent = shaftPower.toFixed(2);
            document.getElementById('motorPower').textContent = selectedPower;
            document.getElementById('motorModel').textContent = motorModel;
            document.getElementById('transmission').textContent = (transmissionEff * 100).toFixed(0);
            
            document.getElementById('resultSection').style.display = 'block';
        }

        function goBack() {
            window.location.href = '../index.html';
        }

        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') calculate();
        });
    </script>
</body>
</html>

