<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>é’¢å¹³å°ç”¨é‡è®¡ç®— - è®¾å¤‡å‚æ•°é€‰å‹ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="../css/tool-common.css">
</head>
<body>
    <div class="tool-container">
        <div class="tool-header">
            <button class="back-btn" onclick="goBack()">â† è¿”å›</button>
            <h1>ğŸ—ï¸ é’¢å¹³å°ç”¨é‡è®¡ç®—</h1>
            <p class="subtitle">å¹³å°ç»“æ„ææ–™ä¼°ç®—ç¨‹åº</p>
        </div>

        <div class="tool-content">
            <div class="input-section">
                <div class="input-group">
                    <label for="length">å¹³å°é•¿åº¦ (m)</label>
                    <input type="number" id="length" placeholder="è¯·è¾“å…¥å¹³å°é•¿åº¦" step="0.1" value="">
                </div>

                <div class="input-group">
                    <label for="width">å¹³å°å®½åº¦ (m)</label>
                    <input type="number" id="width" placeholder="è¯·è¾“å…¥å¹³å°å®½åº¦" step="0.1" value="">
                </div>

                <div class="input-group">
                    <label for="height">å¹³å°é«˜åº¦ (m)</label>
                    <input type="number" id="height" placeholder="è¯·è¾“å…¥å¹³å°é«˜åº¦" step="0.1" value="">
                </div>

                <div class="input-group">
                    <label for="equipment">è®¾å¤‡é‡é‡ (kg)</label>
                    <input type="number" id="equipment" placeholder="0-10000kg" value="0" step="10" min="0" max="10000">
                </div>

                <div class="input-group radio-group">
                    <label>ä¸»æ¢ç±»å‹ï¼š</label>
                    <label><input type="radio" name="beamType" value="channel" checked> æ§½é’¢</label>
                    <label><input type="radio" name="beamType" value="square"> æ–¹ç®¡</label>
                </div>

                <div class="input-group checkbox-group">
                    <input type="checkbox" id="hasGuardrail" checked>
                    <label for="hasGuardrail">éœ€è¦æŠ¤æ </label>
                </div>

                <button class="calc-btn" onclick="calculate()">ğŸ”¨ è®¡ç®—ç”¨é‡</button>
            </div>

            <div class="result-section" id="resultSection" style="display: none;">
                <h3>ğŸ“Š ææ–™æ˜ç»†è¡¨</h3>
                <ul class="result-list" id="resultList"></ul>
            </div>
        </div>
    </div>

    <script>
        // æ£€æŸ¥ç™»å½•çŠ¶æ€
        (function() {
            const sessionInfo = sessionStorage.getItem('currentSession');
            if (!sessionInfo) {
                window.location.href = '../login.html';
            }
        })();

        function calculate() {
            const length = parseFloat(document.getElementById('length').value);
            const width = parseFloat(document.getElementById('width').value);
            const height = parseFloat(document.getElementById('height').value);
            const equipment = parseFloat(document.getElementById('equipment').value) || 0;
            const isSquareTube = document.querySelector('input[name="beamType"]:checked').value === 'square';
            const hasGuardrail = document.getElementById('hasGuardrail').checked;

            // éªŒè¯è¾“å…¥
            if (!length || length <= 0) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„å¹³å°é•¿åº¦');
                return;
            }
            if (!width || width <= 0) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„å¹³å°å®½åº¦');
                return;
            }
            if (!height || height <= 0) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„å¹³å°é«˜åº¦');
                return;
            }
            if (equipment < 0 || equipment > 10000) {
                alert('è®¾å¤‡é‡é‡åº”åœ¨0-10000kgä¹‹é—´');
                return;
            }

            const materials = calculatePlatformMaterials(length, width, height, equipment, isSquareTube, hasGuardrail);
            displayResults(materials);
        }

        function calculatePlatformMaterials(length, width, height, equipment, isSquareTube, hasGuardrail) {
            const results = [];
            
            // è®¡ç®—ä¸»æ¢æ•°é‡ï¼ˆæ ¹æ®å®½åº¦ï¼Œæ¯0.8mä¸€æ ¹ï¼‰
            const mainBeamCount = Math.ceil(width / 0.8) + 1;
            
            // è®¡ç®—æ¬¡æ¢æ•°é‡ï¼ˆæ ¹æ®é•¿åº¦ï¼Œæ¯1.2mä¸€æ ¹ï¼‰
            const secondaryBeamCount = Math.ceil(length / 1.2) + 1;
            
            // ç«‹æŸ±æ•°é‡ï¼ˆå››è§’ + ä¸­é—´æ”¯æ’‘ï¼‰
            const columnCount = 4 + Math.floor(length / 3) * Math.floor(width / 3);
            
            // é€‰æ‹©å‹æè§„æ ¼
            let mainBeamSpec, columnSpec, channelWeight, columnWeight;
            if (isSquareTube) {
                mainBeamSpec = '100*100*5æ–¹ç®¡';
                columnSpec = '100*100*5æ–¹ç®¡';
                channelWeight = 15.0; // kg/m
                columnWeight = 15.0;
            } else {
                mainBeamSpec = '12#æ§½é’¢';
                columnSpec = '10#æ§½é’¢';
                channelWeight = 10.007;
                columnWeight = 8.007;
            }
            
            // ä¸»æ¢é•¿åº¦å’Œé‡é‡
            const mainBeamLength = mainBeamCount * length;
            const mainBeamWeight = mainBeamLength * channelWeight;
            results.push(['ä¸»æ¢', mainBeamSpec, mainBeamCount + 'æ ¹ Ã— ' + length.toFixed(2) + 'm', mainBeamWeight.toFixed(2) + ' kg']);
            
            // æ¬¡æ¢é•¿åº¦å’Œé‡é‡
            const secondaryBeamLength = secondaryBeamCount * width;
            const secondaryBeamWeight = secondaryBeamLength * channelWeight * 0.8;
            results.push(['æ¬¡æ¢', mainBeamSpec, secondaryBeamCount + 'æ ¹ Ã— ' + width.toFixed(2) + 'm', secondaryBeamWeight.toFixed(2) + ' kg']);
            
            // ç«‹æŸ±é•¿åº¦å’Œé‡é‡
            const columnTotalLength = columnCount * height;
            const columnTotalWeight = columnTotalLength * columnWeight;
            results.push(['ç«‹æŸ±', columnSpec, columnCount + 'æ ¹ Ã— ' + height.toFixed(2) + 'm', columnTotalWeight.toFixed(2) + ' kg']);
            
            // æ–œæ‹‰æ†ï¼ˆæ¯ä¸ªç«‹æŸ±2æ ¹ï¼Œé•¿åº¦çº¦ä¸ºé«˜åº¦çš„1.2å€ï¼‰
            const diagonalCount = columnCount * 2;
            const diagonalLength = diagonalCount * height * 1.2;
            const diagonalWeight = diagonalLength * 3.52; // 40*40*3æ–¹ç®¡
            results.push(['æ–œæ‹‰æ†', '40*40*3æ–¹ç®¡', diagonalCount + 'æ ¹', diagonalWeight.toFixed(2) + ' kg']);
            
            // èŠ±çº¹æ¿ï¼ˆ5mmåšï¼‰
            const plateArea = length * width;
            const plateWeight = plateArea * 0.005 * 7850; // 5mmåšé’¢æ¿å¯†åº¦
            results.push(['èŠ±çº¹æ¿', '5mmåš', plateArea.toFixed(2) + ' mÂ²', plateWeight.toFixed(2) + ' kg']);
            
            // è§’é“åŠ å›ºï¼ˆå‘¨è¾¹å’Œå†…éƒ¨ï¼‰
            const angleIronLength = (length + width) * 2 + mainBeamCount * width;
            const angleIronWeight = angleIronLength * 2.332; // 50*5è§’é“
            results.push(['è§’é“', '50*5è§’é“', angleIronLength.toFixed(2) + ' m', angleIronWeight.toFixed(2) + ' kg']);
            
            // ç»“æ„æ€»é‡é‡ï¼ˆä¸å«è®¾å¤‡ï¼‰
            const structureWeight = mainBeamWeight + secondaryBeamWeight + columnTotalWeight + 
                                   diagonalWeight + plateWeight + angleIronWeight;
            
            results.push(['', '', '', '']);
            results.push(['ç»“æ„æ€»é‡é‡', 'ä¸å«è®¾å¤‡é‡é‡', '', structureWeight.toFixed(2) + ' kg']);
            
            // å¦‚æœéœ€è¦æŠ¤æ 
            if (hasGuardrail) {
                results.push(['', '', '', '']);
                results.push(['-----æŠ¤æ ææ–™-----', '', '', '']);
                
                const guardrailLength = (length + width) * 2; // å¹³å°å‘¨é•¿
                const guardrailHeight = 1.05; // æ ‡å‡†æŠ¤æ é«˜åº¦
                
                // æŠ¤æ ç«‹æŸ±
                const guardrailPostCount = Math.ceil(guardrailLength / 1.2) + 1;
                const guardrailPostWeight = guardrailPostCount * guardrailHeight * 5.42;
                results.push(['æŠ¤æ ç«‹æŸ±', '40*60*3æ–¹ç®¡', guardrailPostCount + 'æ ¹', guardrailPostWeight.toFixed(2) + ' kg']);
                
                // æŠ¤æ æ‰¶æ‰‹
                const handrailWeight = guardrailLength * 3.52;
                results.push(['æŠ¤æ æ‰¶æ‰‹', '40*40*3æ–¹ç®¡', guardrailLength.toFixed(2) + ' m', handrailWeight.toFixed(2) + ' kg']);
                
                // ä¸­æ¨ªæ¡£
                const midRailWeight = guardrailLength * 2 * 1.963;
                results.push(['ä¸­æ¨ªæ¡£', '50*5æ‰é“ (2é“)', (guardrailLength * 2).toFixed(2) + ' m', midRailWeight.toFixed(2) + ' kg']);
                
                // è¸¢è„šçº¿
                const kickboardWeight = guardrailLength * 3.14;
                results.push(['è¸¢è„šçº¿', '100*4æ‰é“', guardrailLength.toFixed(2) + ' m', kickboardWeight.toFixed(2) + ' kg']);
                
                const guardrailTotalWeight = guardrailPostWeight + handrailWeight + midRailWeight + kickboardWeight;
                
                results.push(['', '', '', '']);
                results.push(['å¹³å°+æŠ¤æ æ€»é‡', '', '', (structureWeight + guardrailTotalWeight).toFixed(2) + ' kg']);
            }
            
            return results;
        }

        function displayResults(materials) {
            const resultList = document.getElementById('resultList');
            resultList.innerHTML = '';
            
            // æ·»åŠ è¡¨å¤´
            const header = document.createElement('li');
            header.innerHTML = '<span>ææ–™åç§°</span><span>è§„æ ¼å‹å·</span><span>æ•°é‡</span><span>é‡é‡</span>';
            resultList.appendChild(header);
            
            // æ·»åŠ æ•°æ®
            materials.forEach(item => {
                const li = document.createElement('li');
                li.innerHTML = `<span>${item[0]}</span><span>${item[1]}</span><span>${item[2]}</span><span>${item[3]}</span>`;
                resultList.appendChild(li);
            });
            
            document.getElementById('resultSection').style.display = 'block';
        }

        function goBack() {
            window.location.href = '../index.html';
        }

        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') calculate();
        });
    </script>
</body>
</html>

