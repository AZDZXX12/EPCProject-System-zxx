<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¥¼æ¢¯ææ–™è¡¨ - è®¾å¤‡å‚æ•°é€‰å‹ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="../css/tool-common.css">
</head>
<body>
    <div class="tool-container">
        <div class="tool-header">
            <button class="back-btn" onclick="goBack()">â† è¿”å›</button>
            <h1>ğŸªœ æ¥¼æ¢¯ææ–™è¡¨è®¡ç®—</h1>
            <p class="subtitle">é’¢ç»“æ„æ¥¼æ¢¯ææ–™ç”¨é‡è®¡ç®—</p>
        </div>

        <div class="tool-content">
            <div class="input-section">
                <div class="input-group">
                    <label for="angle">æ¥¼æ¢¯è§’åº¦ (åº¦)</label>
                    <input type="number" id="angle" placeholder="æ¨è30-50åº¦" value="45" step="1" min="0" max="90">
                </div>

                <div class="input-group">
                    <label for="height">æ¥¼æ¢¯é«˜åº¦ (mm)</label>
                    <input type="number" id="height" placeholder="è¯·è¾“å…¥æ¥¼æ¢¯é«˜åº¦" value="3000" step="1">
                </div>

                <div class="input-group">
                    <label for="guardrailHeight">æŠ¤æ é«˜åº¦ (mm)</label>
                    <input type="number" id="guardrailHeight" placeholder="å»ºè®®1200mm" value="1200" step="1">
                </div>

                <button class="calc-btn" onclick="calculate()">ğŸ“ è®¡ç®—ææ–™</button>
            </div>

            <div class="result-section" id="resultSection" style="display: none;">
                <h3>ğŸ“Š è®¡ç®—ç»“æœ</h3>
                <div class="result-item">
                    <span class="result-label">è¸æ­¥æ•°é‡ï¼š</span>
                    <span class="result-value" id="steps">-</span>
                    <span class="result-unit">æ­¥</span>
                </div>
                <div class="result-item">
                    <span class="result-label">æ§½é’¢ç”¨é‡ï¼š</span>
                    <span class="result-value" id="channel">-</span>
                    <span class="result-unit">m</span>
                </div>
                <div class="result-item">
                    <span class="result-label">æŠ¤æ ç”¨é‡ï¼š</span>
                    <span class="result-value" id="railing">-</span>
                    <span class="result-unit">m</span>
                </div>
                <div class="result-item">
                    <span class="result-label">æ‰é“ç”¨é‡ï¼š</span>
                    <span class="result-value" id="flatIron">-</span>
                    <span class="result-unit">m</span>
                </div>
                <div class="result-item">
                    <span class="result-label">æ€»é‡é‡ï¼š</span>
                    <span class="result-value" id="weight">-</span>
                    <span class="result-unit">kg</span>
                </div>
            </div>
        </div>
    </div>

    <script>
        // æ£€æŸ¥ç™»å½•çŠ¶æ€
        (function() {
            const sessionInfo = sessionStorage.getItem('currentSession');
            if (!sessionInfo) {
                window.location.href = '../login.html';
            }
        })();

        function calculate() {
            const angle = parseFloat(document.getElementById('angle').value);
            const height = parseFloat(document.getElementById('height').value);
            const guardrailHeight = parseFloat(document.getElementById('guardrailHeight').value);

            if (!angle || angle <= 0 || angle >= 90) {
                alert('æ¥¼æ¢¯è§’åº¦å¿…é¡»åœ¨0-90åº¦ä¹‹é—´');
                return;
            }

            if (!height || height <= 0) {
                alert('æ¥¼æ¢¯é«˜åº¦å¿…é¡»å¤§äº0');
                return;
            }

            if (!guardrailHeight || guardrailHeight <= 0) {
                alert('æŠ¤æ é«˜åº¦å¿…é¡»å¤§äº0');
                return;
            }

            // è®¡ç®—æ¥¼æ¢¯å‚æ•°
            const angleRad = angle * Math.PI / 180;
            const stepHeight = 180; // æ ‡å‡†è¸æ­¥é«˜åº¦ mm
            const stepWidth = 300; // æ ‡å‡†è¸æ­¥å®½åº¦ mm
            
            // è¸æ­¥æ•°é‡
            const stepsCount = Math.ceil(height / stepHeight);
            
            // æ¥¼æ¢¯æ–œé•¿
            const slopeLength = height / Math.sin(angleRad) / 1000; // è½¬æ¢ä¸ºç±³
            
            // æ§½é’¢ç”¨é‡ (ä¸¤æ ¹ä¸»æ¢)
            const channelLength = slopeLength * 2;
            
            // æŠ¤æ ç”¨é‡ (ä¸€ä¾§æŠ¤æ ï¼ŒåŒ…å«ç«‹æŸ±å’Œæ‰¶æ‰‹)
            const railingLength = slopeLength + guardrailHeight / 1000;
            
            // æ‰é“ç”¨é‡ (è¸æ­¥æ¿æ”¯æ’‘)
            const flatIronLength = stepsCount * (stepWidth / 1000) * 2;
            
            // ä¼°ç®—æ€»é‡é‡
            // 12#æ§½é’¢çº¦10.007kg/mï¼Œ40*40*3æ–¹ç®¡çº¦3.52kg/mï¼Œ50*5æ‰é“çº¦1.963kg/m
            const totalWeight = 
                channelLength * 10.007 +  // æ§½é’¢ä¸»æ¢
                railingLength * 3.52 +    // æŠ¤æ æ–¹ç®¡
                flatIronLength * 1.963 +  // æ‰é“è¸æ­¥
                stepsCount * 0.3 * 0.3 * 0.005 * 7850; // èŠ±çº¹æ¿(5mmåš)

            // æ˜¾ç¤ºç»“æœ
            document.getElementById('steps').textContent = stepsCount;
            document.getElementById('channel').textContent = channelLength.toFixed(3);
            document.getElementById('railing').textContent = railingLength.toFixed(3);
            document.getElementById('flatIron').textContent = flatIronLength.toFixed(3);
            document.getElementById('weight').textContent = totalWeight.toFixed(2);
            
            document.getElementById('resultSection').style.display = 'block';
        }

        function goBack() {
            window.location.href = '../index.html';
        }

        // å›è½¦é”®è§¦å‘è®¡ç®—
        document.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                calculate();
            }
        });
    </script>
</body>
</html>

