<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç­›åˆ†æœºç®—æ–™ - è®¾å¤‡å‚æ•°é€‰å‹ç³»ç»Ÿ</title>
    <link rel="stylesheet" href="../css/tool-common.css">
</head>
<body>
    <div class="tool-container">
        <div class="tool-header">
            <button class="back-btn" onclick="goBack()">â† è¿”å›</button>
            <h1>ğŸ”„ æ»šç­’ç­›åˆ†æœºææ–™è®¡ç®—</h1>
            <p class="subtitle">ç­›åˆ†æœºæ”¯æ¶åŠå¹³å°ææ–™ç”¨é‡</p>
        </div>

        <div class="tool-content">
            <div class="input-section">
                <div class="input-group">
                    <label for="diameter">æ»šç­’ç›´å¾„ (m)</label>
                    <select id="diameter">
                        <option value="">è¯·é€‰æ‹©æ»šç­’ç›´å¾„</option>
                        <option value="1.2">1.2m</option>
                        <option value="1.4">1.4m</option>
                        <option value="1.6" selected>1.6m</option>
                        <option value="1.8">1.8m</option>
                        <option value="2.0">2.0m</option>
                        <option value="2.2">2.2m</option>
                        <option value="2.4">2.4m</option>
                        <option value="2.6">2.6m</option>
                        <option value="2.8">2.8m</option>
                    </select>
                </div>

                <div class="input-group">
                    <label for="length">æ»šç­’é•¿åº¦ (m)</label>
                    <select id="length">
                        <option value="">è¯·é€‰æ‹©æ»šç­’é•¿åº¦</option>
                        <option value="4">4m</option>
                        <option value="5">5m</option>
                        <option value="6" selected>6m</option>
                        <option value="7">7m</option>
                        <option value="8">8m</option>
                        <option value="9">9m</option>
                    </select>
                </div>

                <div class="input-group">
                    <label for="height">æ¶è®¾é«˜åº¦ (mm)</label>
                    <input type="number" id="height" placeholder="2000-7000mm" value="3500" min="2000" max="7000">
                </div>

                <div class="input-group">
                    <label for="angle">æ¶è®¾è§’åº¦ (åº¦)</label>
                    <input type="number" id="angle" placeholder="å€¾æ–œè§’åº¦" value="4" min="0" max="15">
                </div>

                <div class="input-group">
                    <label for="width">å¹³å°å®½åº¦ (mm)</label>
                    <input type="number" id="width" placeholder="å·¥ä½œå¹³å°å®½åº¦" value="700">
                </div>

                <div class="input-group">
                    <label for="legCount">æ”¯è…¿æ•°é‡</label>
                    <select id="legCount">
                        <option value="4" selected>4æ¡</option>
                        <option value="6">6æ¡</option>
                        <option value="8">8æ¡</option>
                    </select>
                </div>

                <div class="input-group">
                    <label for="guardrail">æŠ¤æ é«˜åº¦ (mm)</label>
                    <input type="number" id="guardrail" placeholder="æŠ¤æ é«˜åº¦" value="1200">
                </div>

                <button class="calc-btn" onclick="calculate()">ğŸ”¨ è®¡ç®—ç”¨é‡</button>
            </div>

            <div class="result-section" id="resultSection" style="display: none;">
                <h3>ğŸ“Š ææ–™æ˜ç»†è¡¨</h3>
                <ul class="result-list" id="resultList"></ul>
            </div>
        </div>
    </div>

    <script>
        // æ£€æŸ¥ç™»å½•çŠ¶æ€
        (function() {
            const sessionInfo = sessionStorage.getItem('currentSession');
            if (!sessionInfo) {
                window.location.href = '../login.html';
            }
        })();

        function calculate() {
            const diameter = parseFloat(document.getElementById('diameter').value);
            const length = parseFloat(document.getElementById('length').value);
            const height = parseFloat(document.getElementById('height').value);
            const angle = parseFloat(document.getElementById('angle').value);
            const width = parseFloat(document.getElementById('width').value);
            const legCount = parseInt(document.getElementById('legCount').value);
            const guardrailHeight = parseFloat(document.getElementById('guardrail').value);

            // éªŒè¯è¾“å…¥
            if (!diameter) {
                alert('è¯·é€‰æ‹©æ»šç­’ç›´å¾„');
                return;
            }
            if (!length) {
                alert('è¯·é€‰æ‹©æ»šç­’é•¿åº¦');
                return;
            }
            if (!height || height < 2000 || height > 7000) {
                alert('æ¶è®¾é«˜åº¦éœ€åœ¨2000-7000mmä¹‹é—´');
                return;
            }
            if (!width || width <= 0) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„å·¥ä½œå¹³å°å®½åº¦');
                return;
            }
            if (!guardrailHeight || guardrailHeight <= 0) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„æŠ¤æ é«˜åº¦');
                return;
            }

            const materials = calculateMaterials(diameter * 1000, length * 1000, height, width, legCount, guardrailHeight, angle);
            displayResults(materials);
        }

        function calculateMaterials(diameter, length, height, width, legCount, guardrailHeight, angle) {
            const results = [];
            
            // === æ”¯è…¿ææ–™ ===
            results.push(['ã€æ”¯è…¿ææ–™ã€‘', '', '', '']);
            
            // æ ¹æ®é«˜åº¦é€‰æ‹©æ”¯è…¿å‹å·
            let legSpec, legUnitWeight, legLogic;
            if (height <= 3000) {
                legSpec = '10#æ§½é’¢';
                legUnitWeight = 8.007;
                legLogic = 'é«˜åº¦â‰¤3m';
            } else if (height <= 5000) {
                legSpec = '12#æ§½é’¢';
                legUnitWeight = 10.007;
                legLogic = '3m<é«˜åº¦â‰¤5m';
            } else {
                legSpec = '14#æ§½é’¢';
                legUnitWeight = 12.059;
                legLogic = 'é«˜åº¦>5m';
            }
            
            const legLength = legCount * (height / 1000);
            const legWeight = legLength * legUnitWeight;
            
            results.push(['é€‰å‹é€»è¾‘', legLogic, '', '']);
            results.push(['å‹å·', legSpec, legCount + 'æ ¹', '']);
            results.push(['æ€»é•¿åº¦', '', legLength.toFixed(2) + ' m', '']);
            results.push(['æ€»é‡é‡', '', '', legWeight.toFixed(2) + ' kg']);
            
            // === å¹³å°ææ–™ ===
            results.push(['', '', '', '']);
            results.push(['ã€å¹³å°ææ–™ã€‘', '', '', '']);
            
            // æ¨ªæ’‘æ•°é‡ï¼ˆæ ¹æ®é•¿åº¦ï¼‰
            const crossBeamCount = Math.ceil(length / 1500);
            results.push(['æ¨ªæ’‘æ•°é‡', '', crossBeamCount + 'æ ¹', '']);
            
            // ä¸¤è¾¹å¹³å°æ§½é’¢
            const sidePlatformLength = 2 * (length / 1000 + 0.4);
            const sidePlatformWeight = sidePlatformLength * 10.007;
            results.push(['ä¸¤è¾¹å¹³å°æ§½é’¢', '12#æ§½é’¢', sidePlatformLength.toFixed(2) + ' m', sidePlatformWeight.toFixed(2) + ' kg']);
            
            // ä¸¤è¾¹å¹³å°è§’é“
            const sideAngleLength = 2 * (length / 1000 + 0.4);
            const sideAngleWeight = sideAngleLength * 3.77;
            results.push(['ä¸¤è¾¹å¹³å°è§’é“', '50*50*5è§’é“', sideAngleLength.toFixed(2) + ' m', sideAngleWeight.toFixed(2) + ' kg']);
            
            // å‰å¹³å°æ§½é’¢
            const frontPlatformLength = (width / 1000) * 2;
            const frontPlatformWeight = frontPlatformLength * 10.007;
            results.push(['å‰å¹³å°æ§½é’¢', '12#æ§½é’¢', frontPlatformLength.toFixed(2) + ' m', frontPlatformWeight.toFixed(2) + ' kg']);
            
            // åå¹³å°æ§½é’¢ï¼ˆå«æ»šç­’ç›´å¾„ï¼‰
            const backPlatformLength = (width / 1000 + diameter / 1000) * 2;
            const backPlatformWeight = backPlatformLength * 10.007;
            results.push(['åå¹³å°æ§½é’¢', '12#æ§½é’¢', backPlatformLength.toFixed(2) + ' m', backPlatformWeight.toFixed(2) + ' kg']);
            
            // èŠ±çº¹æ¿
            const plateArea = (length / 1000 + 0.8 + width / 1000 * 4 + diameter / 1000 * 2) * (width / 1000);
            const plateWeight = plateArea * 0.005 * 7850;
            results.push(['èŠ±çº¹æ¿', '5mmåš', plateArea.toFixed(2) + ' mÂ²', plateWeight.toFixed(2) + ' kg']);
            
            // å¹³å°æ€»é‡é‡
            const platformTotal = sidePlatformWeight + sideAngleWeight + frontPlatformWeight + backPlatformWeight + plateWeight;
            results.push(['å¹³å°æ€»é‡é‡', '', '', platformTotal.toFixed(2) + ' kg']);
            
            // === æŠ¤æ ææ–™ ===
            results.push(['', '', '', '']);
            results.push(['ã€æŠ¤æ ææ–™ã€‘', '', '', '']);
            
            const guardrailLength = (length / 1000 + 0.8 + width / 1000 * 4 + diameter / 1000 * 2);
            const guardrailHeightM = guardrailHeight / 1000;
            
            // æŠ¤æ ç«‹æŸ±
            const postCount = Math.ceil(guardrailLength / 1.2) + 1;
            const postWeight = postCount * guardrailHeightM * 5.42;
            results.push(['ç«‹æŸ±', '40*60*3æ–¹ç®¡', postCount + 'æ ¹', postWeight.toFixed(2) + ' kg']);
            
            // æ‰¶æ‰‹
            const handrailWeight = guardrailLength * 3.52;
            results.push(['æ‰¶æ‰‹', '40*40*3æ–¹ç®¡', guardrailLength.toFixed(2) + ' m', handrailWeight.toFixed(2) + ' kg']);
            
            // ä¸­æ¨ªæ¡£
            const midRailWeight = guardrailLength * 2 * 1.963;
            results.push(['ä¸­æ¨ªæ¡£', '50*5æ‰é“ (2é“)', (guardrailLength * 2).toFixed(2) + ' m', midRailWeight.toFixed(2) + ' kg']);
            
            // è¸¢è„šçº¿
            const kickboardWeight = guardrailLength * 3.14;
            results.push(['è¸¢è„šçº¿', '100*4æ‰é“', guardrailLength.toFixed(2) + ' m', kickboardWeight.toFixed(2) + ' kg']);
            
            // æŠ¤æ æ€»é‡
            const guardrailTotal = postWeight + handrailWeight + midRailWeight + kickboardWeight;
            results.push(['æŠ¤æ æ€»é‡é‡', '', '', guardrailTotal.toFixed(2) + ' kg']);
            
            // === é¡¹ç›®æ€»é‡é‡ ===
            results.push(['', '', '', '']);
            results.push(['ã€é¡¹ç›®æ€»é‡é‡ã€‘', '', '', '']);
            results.push(['æ”¯è…¿æ€»é‡é‡', '', '', legWeight.toFixed(2) + ' kg']);
            results.push(['å¹³å°æ€»é‡é‡', '', '', platformTotal.toFixed(2) + ' kg']);
            results.push(['æŠ¤æ æ€»é‡é‡', '', '', guardrailTotal.toFixed(2) + ' kg']);
            
            const projectTotal = legWeight + platformTotal + guardrailTotal;
            results.push(['åˆè®¡æ€»é‡é‡', '', '', projectTotal.toFixed(2) + ' kg']);
            
            // å®‰å…¨è­¦å‘Š
            if (guardrailHeightM < 1.05) {
                results.push(['', '', '', '']);
                results.push(['ã€å®‰å…¨è­¦å‘Šã€‘', 'æŠ¤æ é«˜åº¦ä¸ç¬¦åˆGB4053.3-2009æ ‡å‡†è¦æ±‚(â‰¥1050mm)!', '', '']);
            }
            
            return results;
        }

        function displayResults(materials) {
            const resultList = document.getElementById('resultList');
            resultList.innerHTML = '';
            
            // æ·»åŠ è¡¨å¤´
            const header = document.createElement('li');
            header.innerHTML = '<span>ææ–™åç§°</span><span>è§„æ ¼/æè¿°</span><span>æ•°é‡</span><span>é‡é‡</span>';
            resultList.appendChild(header);
            
            // æ·»åŠ æ•°æ®
            materials.forEach(item => {
                const li = document.createElement('li');
                li.innerHTML = `<span>${item[0]}</span><span>${item[1]}</span><span>${item[2]}</span><span>${item[3]}</span>`;
                resultList.appendChild(li);
            });
            
            document.getElementById('resultSection').style.display = 'block';
        }

        function goBack() {
            window.location.href = '../index.html';
        }
    </script>
</body>
</html>

