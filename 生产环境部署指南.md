# ğŸš€ EPCé¡¹ç›®ç®¡ç†ç³»ç»Ÿ - ç”Ÿäº§ç¯å¢ƒéƒ¨ç½²æŒ‡å—

> ç‰ˆæœ¬: 2.0.0  
> æ›´æ–°æ—¶é—´: 2025-11-11

---

## ğŸ“‹ ç›®å½•

1. [éƒ¨ç½²å‰å‡†å¤‡](#éƒ¨ç½²å‰å‡†å¤‡)
2. [ç¯å¢ƒé…ç½®](#ç¯å¢ƒé…ç½®)
3. [å‰ç«¯éƒ¨ç½²](#å‰ç«¯éƒ¨ç½²)
4. [åç«¯éƒ¨ç½²](#åç«¯éƒ¨ç½²)
5. [æ•°æ®åº“é…ç½®](#æ•°æ®åº“é…ç½®)
6. [åŸŸåå’ŒSSLé…ç½®](#åŸŸåå’Œsslé…ç½®)
7. [ç›‘æ§å’Œæ—¥å¿—](#ç›‘æ§å’Œæ—¥å¿—)
8. [å¸¸è§é—®é¢˜](#å¸¸è§é—®é¢˜)

---

## éƒ¨ç½²å‰å‡†å¤‡

### ç³»ç»Ÿè¦æ±‚

**å‰ç«¯æœåŠ¡å™¨**
- Node.js >= 16.0.0
- npm >= 8.0.0
- å†…å­˜ >= 2GB
- ç£ç›˜ >= 10GB

**åç«¯æœåŠ¡å™¨**
- Python >= 3.9
- pip >= 21.0
- å†…å­˜ >= 4GB
- ç£ç›˜ >= 20GB

**æ•°æ®åº“æœåŠ¡å™¨**
- PostgreSQL >= 13 (æ¨è)
- æˆ– MySQL >= 8.0
- æˆ– MongoDB >= 5.0

### å¿…å¤‡å·¥å…·

```bash
# Git
git --version

# Node.jså’Œnpm
node --version
npm --version

# Pythonå’Œpip
python --version
pip --version

# PM2 (è¿›ç¨‹ç®¡ç†)
npm install -g pm2

# Nginx (åå‘ä»£ç†)
nginx -v
```

---

## ç¯å¢ƒé…ç½®

### 1. å…‹éš†ä»£ç 

```bash
# å…‹éš†ä»“åº“
git clone https://github.com/your-org/EPCProject-System.git
cd EPCProject-System

# åˆ‡æ¢åˆ°ç”Ÿäº§åˆ†æ”¯
git checkout production
```

### 2. å‰ç«¯ç¯å¢ƒå˜é‡

åˆ›å»º `client/.env.production`:

```env
# ç”Ÿäº§ç¯å¢ƒé…ç½®
NODE_ENV=production

# APIåœ°å€ï¼ˆæ›¿æ¢ä¸ºå®é™…åç«¯åœ°å€ï¼‰
REACT_APP_API_URL=https://api.your-domain.com

# åº”ç”¨ä¿¡æ¯
REACT_APP_NAME=EPCé¡¹ç›®ç®¡ç†ç³»ç»Ÿ
REACT_APP_VERSION=2.0.0

# åŠŸèƒ½å¼€å…³
REACT_APP_USE_MOCK=false
REACT_APP_DEBUG=false
REACT_APP_ENABLE_MONITORING=true

# Sentryé”™è¯¯ç›‘æ§ï¼ˆå¯é€‰ï¼‰
REACT_APP_SENTRY_DSN=your-sentry-dsn

# Google Analyticsï¼ˆå¯é€‰ï¼‰
REACT_APP_GA_ID=your-ga-id

# å®‰å…¨é…ç½®
REACT_APP_CSRF_HEADER=X-CSRFToken
REACT_APP_SESSION_TIMEOUT=30

# æ–‡ä»¶ä¸Šä¼ 
REACT_APP_MAX_FILE_SIZE=10
REACT_APP_ALLOWED_FILE_TYPES=.pdf,.doc,.docx,.xls,.xlsx,.jpg,.png

# æ„å»ºè·¯å¾„
PUBLIC_URL=https://your-domain.com
```

### 3. åç«¯ç¯å¢ƒå˜é‡

åˆ›å»º `server/.env`:

```env
# ç”Ÿäº§ç¯å¢ƒé…ç½®
ENVIRONMENT=production
DEBUG=False

# æ•°æ®åº“é…ç½®ï¼ˆPostgreSQLç¤ºä¾‹ï¼‰
DATABASE_URL=postgresql://user:password@localhost:5432/epc_db

# æˆ–ä½¿ç”¨MySQL
# DATABASE_URL=mysql://user:password@localhost:3306/epc_db

# æˆ–ä½¿ç”¨MongoDB
# MONGODB_URL=mongodb://user:password@localhost:27017/epc_db

# å®‰å…¨é…ç½®
SECRET_KEY=your-super-secret-key-change-this-in-production
ALLOWED_HOSTS=your-domain.com,www.your-domain.com
CORS_ALLOWED_ORIGINS=https://your-domain.com,https://www.your-domain.com

# Redisé…ç½®ï¼ˆç”¨äºCeleryä»»åŠ¡é˜Ÿåˆ—ï¼‰
REDIS_URL=redis://localhost:6379/0

# é‚®ä»¶é…ç½®ï¼ˆå¯é€‰ï¼‰
EMAIL_HOST=smtp.gmail.com
EMAIL_PORT=587
EMAIL_USE_TLS=True
EMAIL_HOST_USER=your-email@gmail.com
EMAIL_HOST_PASSWORD=your-email-password

# æ–‡ä»¶å­˜å‚¨ï¼ˆå¯é€‰ï¼Œä½¿ç”¨äº‘å­˜å‚¨ï¼‰
# AWS_ACCESS_KEY_ID=your-aws-key
# AWS_SECRET_ACCESS_KEY=your-aws-secret
# AWS_STORAGE_BUCKET_NAME=your-bucket-name
# AWS_S3_REGION_NAME=us-east-1

# æ—¥å¿—é…ç½®
LOG_LEVEL=INFO
LOG_FILE=/var/log/epc/app.log
```

---

## å‰ç«¯éƒ¨ç½²

### æ–¹å¼ä¸€ï¼šé™æ€æ–‡ä»¶éƒ¨ç½²ï¼ˆæ¨èï¼‰

#### 1. æ„å»ºç”Ÿäº§ç‰ˆæœ¬

```bash
cd client

# å®‰è£…ä¾èµ–
npm install --production=false

# æ„å»º
npm run build

# æ„å»ºäº§ç‰©åœ¨ build/ ç›®å½•
```

#### 2. ä½¿ç”¨Nginxéƒ¨ç½²

å®‰è£…Nginx:
```bash
# Ubuntu/Debian
sudo apt update
sudo apt install nginx

# CentOS/RHEL
sudo yum install nginx
```

é…ç½®Nginx (`/etc/nginx/sites-available/epc-frontend`):

```nginx
server {
    listen 80;
    server_name your-domain.com www.your-domain.com;
    
    # é‡å®šå‘åˆ°HTTPS
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name your-domain.com www.your-domain.com;
    
    # SSLè¯ä¹¦é…ç½®
    ssl_certificate /etc/ssl/certs/your-domain.crt;
    ssl_certificate_key /etc/ssl/private/your-domain.key;
    ssl_protocols TLSv1.2 TLSv1.3;
    ssl_ciphers HIGH:!aNULL:!MD5;
    
    # ç½‘ç«™æ ¹ç›®å½•
    root /var/www/epc-frontend/build;
    index index.html;
    
    # Gzipå‹ç¼©
    gzip on;
    gzip_types text/plain text/css application/json application/javascript text/xml application/xml application/xml+rss text/javascript;
    gzip_min_length 1000;
    
    # é™æ€æ–‡ä»¶ç¼“å­˜
    location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg|woff|woff2|ttf|eot)$ {
        expires 1y;
        add_header Cache-Control "public, immutable";
    }
    
    # SPAè·¯ç”±æ”¯æŒ
    location / {
        try_files $uri $uri/ /index.html;
    }
    
    # APIä»£ç†ï¼ˆå¯é€‰ï¼Œå¦‚æœå‰åç«¯åŒåŸŸï¼‰
    location /api/ {
        proxy_pass http://localhost:8000;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
    }
    
    # å®‰å…¨å¤´
    add_header X-Frame-Options "SAMEORIGIN" always;
    add_header X-Content-Type-Options "nosniff" always;
    add_header X-XSS-Protection "1; mode=block" always;
    add_header Referrer-Policy "no-referrer-when-downgrade" always;
}
```

å¯ç”¨é…ç½®:
```bash
# åˆ›å»ºç¬¦å·é“¾æ¥
sudo ln -s /etc/nginx/sites-available/epc-frontend /etc/nginx/sites-enabled/

# æµ‹è¯•é…ç½®
sudo nginx -t

# é‡å¯Nginx
sudo systemctl restart nginx
```

#### 3. éƒ¨ç½²æ–‡ä»¶

```bash
# å¤åˆ¶æ„å»ºæ–‡ä»¶åˆ°æœåŠ¡å™¨
sudo mkdir -p /var/www/epc-frontend
sudo cp -r build/* /var/www/epc-frontend/

# è®¾ç½®æƒé™
sudo chown -R www-data:www-data /var/www/epc-frontend
sudo chmod -R 755 /var/www/epc-frontend
```

### æ–¹å¼äºŒï¼šä½¿ç”¨PM2éƒ¨ç½²

```bash
cd client

# å®‰è£…serve
npm install -g serve

# ä½¿ç”¨PM2å¯åŠ¨
pm2 start serve --name epc-frontend -- -s build -l 3000

# ä¿å­˜PM2é…ç½®
pm2 save

# è®¾ç½®å¼€æœºè‡ªå¯
pm2 startup
```

---

## åç«¯éƒ¨ç½²

### 1. å®‰è£…ä¾èµ–

```bash
cd server

# åˆ›å»ºè™šæ‹Ÿç¯å¢ƒ
python -m venv venv
source venv/bin/activate  # Linux/Mac
# venv\Scripts\activate  # Windows

# å®‰è£…ä¾èµ–
pip install -r requirements.txt

# å®‰è£…ç”Ÿäº§æœåŠ¡å™¨
pip install gunicorn
```

### 2. æ•°æ®åº“è¿ç§»

```bash
# åˆå§‹åŒ–æ•°æ®åº“
python -m alembic upgrade head

# åˆ›å»ºè¶…çº§ç”¨æˆ·
python create_superuser.py
```

### 3. ä½¿ç”¨Gunicornå¯åŠ¨

åˆ›å»º `gunicorn.conf.py`:

```python
import multiprocessing

# æœåŠ¡å™¨é…ç½®
bind = "0.0.0.0:8000"
workers = multiprocessing.cpu_count() * 2 + 1
worker_class = "uvicorn.workers.UvicornWorker"
max_requests = 1000
max_requests_jitter = 50
timeout = 30
keepalive = 5

# æ—¥å¿—é…ç½®
accesslog = "/var/log/epc/access.log"
errorlog = "/var/log/epc/error.log"
loglevel = "info"

# è¿›ç¨‹å‘½å
proc_name = "epc-backend"

# å®ˆæŠ¤è¿›ç¨‹
daemon = False
pidfile = "/var/run/epc-backend.pid"
```

å¯åŠ¨æœåŠ¡:
```bash
# åˆ›å»ºæ—¥å¿—ç›®å½•
sudo mkdir -p /var/log/epc
sudo chown $USER:$USER /var/log/epc

# å¯åŠ¨Gunicorn
gunicorn -c gunicorn.conf.py main:app
```

### 4. ä½¿ç”¨PM2ç®¡ç†ï¼ˆæ¨èï¼‰

åˆ›å»º `ecosystem.config.js`:

```javascript
module.exports = {
  apps: [{
    name: 'epc-backend',
    script: 'venv/bin/gunicorn',
    args: '-c gunicorn.conf.py main:app',
    cwd: '/path/to/server',
    instances: 1,
    autorestart: true,
    watch: false,
    max_memory_restart: '1G',
    env: {
      NODE_ENV: 'production',
      PYTHONPATH: '/path/to/server'
    }
  }]
};
```

å¯åŠ¨:
```bash
pm2 start ecosystem.config.js
pm2 save
pm2 startup
```

### 5. Nginxåå‘ä»£ç†

é…ç½® `/etc/nginx/sites-available/epc-backend`:

```nginx
upstream epc_backend {
    server 127.0.0.1:8000;
}

server {
    listen 80;
    server_name api.your-domain.com;
    return 301 https://$server_name$request_uri;
}

server {
    listen 443 ssl http2;
    server_name api.your-domain.com;
    
    ssl_certificate /etc/ssl/certs/your-domain.crt;
    ssl_certificate_key /etc/ssl/private/your-domain.key;
    
    location / {
        proxy_pass http://epc_backend;
        proxy_set_header Host $host;
        proxy_set_header X-Real-IP $remote_addr;
        proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
        proxy_set_header X-Forwarded-Proto $scheme;
        
        # WebSocketæ”¯æŒ
        proxy_http_version 1.1;
        proxy_set_header Upgrade $http_upgrade;
        proxy_set_header Connection "upgrade";
        
        # è¶…æ—¶è®¾ç½®
        proxy_connect_timeout 60s;
        proxy_send_timeout 60s;
        proxy_read_timeout 60s;
    }
}
```

---

## æ•°æ®åº“é…ç½®

### PostgreSQLï¼ˆæ¨èï¼‰

```bash
# å®‰è£…PostgreSQL
sudo apt install postgresql postgresql-contrib

# åˆ›å»ºæ•°æ®åº“å’Œç”¨æˆ·
sudo -u postgres psql

CREATE DATABASE epc_db;
CREATE USER epc_user WITH PASSWORD 'your-password';
GRANT ALL PRIVILEGES ON DATABASE epc_db TO epc_user;
\q

# é…ç½®è¿œç¨‹è®¿é—®ï¼ˆå¦‚éœ€è¦ï¼‰
sudo nano /etc/postgresql/13/main/postgresql.conf
# ä¿®æ”¹: listen_addresses = '*'

sudo nano /etc/postgresql/13/main/pg_hba.conf
# æ·»åŠ : host all all 0.0.0.0/0 md5

sudo systemctl restart postgresql
```

### å¤‡ä»½ç­–ç•¥

```bash
# åˆ›å»ºå¤‡ä»½è„šæœ¬
cat > /usr/local/bin/backup-epc-db.sh << 'EOF'
#!/bin/bash
BACKUP_DIR="/var/backups/epc"
DATE=$(date +%Y%m%d_%H%M%S)
mkdir -p $BACKUP_DIR

# å¤‡ä»½æ•°æ®åº“
pg_dump -U epc_user epc_db | gzip > $BACKUP_DIR/epc_db_$DATE.sql.gz

# åˆ é™¤30å¤©å‰çš„å¤‡ä»½
find $BACKUP_DIR -name "*.sql.gz" -mtime +30 -delete
EOF

chmod +x /usr/local/bin/backup-epc-db.sh

# æ·»åŠ åˆ°crontabï¼ˆæ¯å¤©å‡Œæ™¨2ç‚¹å¤‡ä»½ï¼‰
crontab -e
# æ·»åŠ : 0 2 * * * /usr/local/bin/backup-epc-db.sh
```

---

## åŸŸåå’ŒSSLé…ç½®

### ä½¿ç”¨Let's Encryptå…è´¹SSL

```bash
# å®‰è£…Certbot
sudo apt install certbot python3-certbot-nginx

# è·å–è¯ä¹¦
sudo certbot --nginx -d your-domain.com -d www.your-domain.com

# è‡ªåŠ¨ç»­æœŸ
sudo certbot renew --dry-run

# æ·»åŠ åˆ°crontab
sudo crontab -e
# æ·»åŠ : 0 3 * * * certbot renew --quiet
```

---

## ç›‘æ§å’Œæ—¥å¿—

### 1. ç³»ç»Ÿç›‘æ§

ä½¿ç”¨PM2ç›‘æ§:
```bash
pm2 monit
pm2 logs
pm2 status
```

### 2. æ—¥å¿—ç®¡ç†

é…ç½®logrotate (`/etc/logrotate.d/epc`):

```
/var/log/epc/*.log {
    daily
    rotate 30
    compress
    delaycompress
    notifempty
    create 0640 www-data www-data
    sharedscripts
    postrotate
        systemctl reload nginx
    endscript
}
```

### 3. æ€§èƒ½ç›‘æ§

å®‰è£…ç›‘æ§å·¥å…·:
```bash
# å®‰è£…Prometheuså’ŒGrafanaï¼ˆå¯é€‰ï¼‰
# æˆ–ä½¿ç”¨äº‘ç›‘æ§æœåŠ¡å¦‚New Relicã€Datadogç­‰
```

---

## å¸¸è§é—®é¢˜

### Q1: å‰ç«¯æ— æ³•è¿æ¥åç«¯API
**A:** æ£€æŸ¥CORSé…ç½®ï¼Œç¡®ä¿åç«¯å…è®¸å‰ç«¯åŸŸåè®¿é—®

### Q2: æ•°æ®åº“è¿æ¥å¤±è´¥
**A:** æ£€æŸ¥æ•°æ®åº“URLé…ç½®ï¼Œç¡®ä¿æ•°æ®åº“æœåŠ¡è¿è¡Œæ­£å¸¸

### Q3: SSLè¯ä¹¦é”™è¯¯
**A:** ç¡®ä¿è¯ä¹¦è·¯å¾„æ­£ç¡®ï¼Œè¯ä¹¦æœªè¿‡æœŸ

### Q4: æ€§èƒ½é—®é¢˜
**A:** 
- å¯ç”¨Nginxç¼“å­˜
- ä¼˜åŒ–æ•°æ®åº“æŸ¥è¯¢
- ä½¿ç”¨CDNåŠ é€Ÿé™æ€èµ„æº
- å¢åŠ æœåŠ¡å™¨èµ„æº

### Q5: å¦‚ä½•å›æ»šç‰ˆæœ¬
**A:**
```bash
# å‰ç«¯å›æ»š
cd /var/www/epc-frontend
git checkout previous-version
npm run build

# åç«¯å›æ»š
cd /path/to/server
git checkout previous-version
pm2 restart epc-backend
```

---

## å®‰å…¨æ£€æŸ¥æ¸…å•

- [ ] æ›´æ”¹æ‰€æœ‰é»˜è®¤å¯†ç 
- [ ] å¯ç”¨HTTPS
- [ ] é…ç½®é˜²ç«å¢™
- [ ] é™åˆ¶æ•°æ®åº“è¿œç¨‹è®¿é—®
- [ ] å¯ç”¨æ—¥å¿—è®°å½•
- [ ] å®šæœŸå¤‡ä»½æ•°æ®
- [ ] æ›´æ–°ç³»ç»Ÿå’Œä¾èµ–
- [ ] é…ç½®é”™è¯¯ç›‘æ§
- [ ] è®¾ç½®è®¿é—®é™åˆ¶
- [ ] å¯ç”¨CSRFä¿æŠ¤

---

## è”ç³»æ”¯æŒ

- æŠ€æœ¯æ–‡æ¡£: https://docs.your-domain.com
- Issueè¿½è¸ª: https://github.com/your-org/EPCProject-System/issues
- é‚®ä»¶æ”¯æŒ: support@your-domain.com

---

**æœ€åæ›´æ–°**: 2025-11-11  
**ç»´æŠ¤è€…**: EPCé¡¹ç›®å›¢é˜Ÿ
