# è®¾å¤‡é€‰å‹ç³»ç»Ÿé›†æˆæ–¹æ¡ˆ ğŸ”§

> å°† Luckysheet é€‰å‹ç³»ç»Ÿé›†æˆåˆ°åŒ–å·¥é¡¹ç›®ç®¡ç†ç³»ç»Ÿ

---

## ğŸ“‹ æ¦‚è¿°

### å¾…é›†æˆç³»ç»Ÿ

ä» `C:\Users\Administrator\Desktop\Luckysheet-master-2.0.2\dist-refactored` é›†æˆä»¥ä¸‹ç³»ç»Ÿï¼š

| ç³»ç»Ÿ | æ–‡ä»¶ | åŠŸèƒ½ |
|------|------|------|
| **ç¦»å¿ƒé£æœºé€‰å‹** | fan-selector.html | é£æœºé€‰å‹è®¡ç®—ã€æ€§èƒ½æ›²çº¿ |
| **YJVç”µç¼†é€‰å‹** | cable-selector-table.html | ç”µç¼†é€‰å‹æ•°æ®è¡¨ã€è§„æ ¼æŸ¥è¯¢ |
| **Luckysheetè¡¨æ ¼** | index.html | Excel ç±»è¡¨æ ¼ç¼–è¾‘å™¨ |

### é›†æˆç›®æ ‡

åœ¨åŒ–å·¥é¡¹ç›®ç®¡ç†ç³»ç»Ÿä¸­æ·»åŠ "è®¾å¤‡é€‰å‹"æ¨¡å—ï¼Œæä¾›ï¼š
- âœ… é£æœºé€‰å‹å·¥å…·
- âœ… ç”µç¼†é€‰å‹å·¥å…·
- âœ… åœ¨çº¿è¡¨æ ¼ç¼–è¾‘
- âœ… é€‰å‹ç»“æœä¸é¡¹ç›®æ•°æ®è”åŠ¨

---

## ğŸš€ é›†æˆæ–¹æ¡ˆï¼ˆæ¨èï¼‰

### æ–¹æ¡ˆ1ï¼šiframe åµŒå…¥ï¼ˆå¿«é€Ÿé›†æˆï¼‰â­

**ä¼˜ç‚¹**:
- âœ… å¿«é€Ÿå®ç°ï¼ˆ30åˆ†é’Ÿï¼‰
- âœ… ä¿æŒåŸæœ‰åŠŸèƒ½100%
- âœ… ç‹¬ç«‹ç»´æŠ¤
- âœ… æ— éœ€ä¿®æ”¹åŸç³»ç»Ÿ

**ç¼ºç‚¹**:
- âš ï¸ æ ·å¼éš”ç¦»
- âš ï¸ æ•°æ®äº¤äº’å¤æ‚

**é€‚ç”¨åœºæ™¯**: å¿«é€Ÿä¸Šçº¿ï¼Œæš‚ä¸éœ€è¦æ·±åº¦æ•°æ®äº¤äº’

---

### æ–¹æ¡ˆ2ï¼šReact ç»„ä»¶åŒ–ï¼ˆæ·±åº¦é›†æˆï¼‰

**ä¼˜ç‚¹**:
- âœ… ç»Ÿä¸€UIé£æ ¼
- âœ… æ·±åº¦æ•°æ®äº¤äº’
- âœ… çŠ¶æ€ç®¡ç†ç»Ÿä¸€
- âœ… æ›´å¥½çš„ç”¨æˆ·ä½“éªŒ

**ç¼ºç‚¹**:
- âš ï¸ éœ€è¦é‡æ„ï¼ˆ1-2å¤©ï¼‰
- âš ï¸ éœ€è¦è¿ç§» JavaScript é€»è¾‘

**é€‚ç”¨åœºæ™¯**: é•¿æœŸç»´æŠ¤ï¼Œéœ€è¦æ·±åº¦åŠŸèƒ½æ•´åˆ

---

## ğŸ“ æ–¹æ¡ˆ1å®æ–½æ­¥éª¤ï¼ˆå¿«é€Ÿé›†æˆï¼‰

### ç¬¬ä¸€æ­¥ï¼šå¤åˆ¶é€‰å‹ç³»ç»Ÿæ–‡ä»¶

```bash
# åœ¨é¡¹ç›®æ ¹ç›®å½•æ‰§è¡Œ
mkdir client/public/selection-tools
xcopy /E /I "C:\Users\Administrator\Desktop\Luckysheet-master-2.0.2\dist-refactored" client/public/selection-tools
```

### ç¬¬äºŒæ­¥ï¼šåˆ›å»ºé€‰å‹ç³»ç»Ÿè·¯ç”±é¡µé¢

åˆ›å»ºä»¥ä¸‹ React ç»„ä»¶ï¼š

#### 1. è®¾å¤‡é€‰å‹ä¸»é¡µé¢
**æ–‡ä»¶**: `client/src/pages/EquipmentSelection.tsx`

```tsx
import React from 'react';
import { Card, Row, Col, Typography } from 'antd';
import { ToolOutlined, ThunderboltOutlined, TableOutlined } from '@ant-design/icons';
import { useNavigate } from 'react-router-dom';
import './EquipmentSelection.css';

const { Title, Paragraph } = Typography;

const EquipmentSelection: React.FC = () => {
  const navigate = useNavigate();

  const tools = [
    {
      id: 'fan',
      title: 'ç¦»å¿ƒé£æœºé€‰å‹',
      icon: <ToolOutlined style={{ fontSize: 48, color: '#1890ff' }} />,
      description: 'æ ¹æ®é£é‡ã€é£å‹ç­‰å‚æ•°æ™ºèƒ½é€‰æ‹©åˆé€‚çš„ç¦»å¿ƒé£æœºå‹å·',
      features: ['æ€§èƒ½æ›²çº¿å›¾', 'åŠŸç‡è®¡ç®—', 'æ™ºèƒ½æ¨è'],
      path: '/selection/fan',
    },
    {
      id: 'cable',
      title: 'YJVç”µç¼†é€‰å‹',
      icon: <ThunderboltOutlined style={{ fontSize: 48, color: '#52c41a' }} />,
      description: 'YJVç”µç¼†è§„æ ¼æŸ¥è¯¢ï¼Œæ”¯æŒå¿«é€Ÿæœç´¢å’Œå‚æ•°å¯¹æ¯”',
      features: ['è§„æ ¼æŸ¥è¯¢', 'è½½æµé‡è®¡ç®—', 'å¿«é€Ÿæœç´¢'],
      path: '/selection/cable',
    },
    {
      id: 'table',
      title: 'åœ¨çº¿è¡¨æ ¼ç¼–è¾‘',
      icon: <TableOutlined style={{ fontSize: 48, color: '#fa8c16' }} />,
      description: 'ç±»Excelåœ¨çº¿è¡¨æ ¼ï¼Œæ”¯æŒå…¬å¼ã€å›¾è¡¨ã€æ•°æ®å¯¼å…¥å¯¼å‡º',
      features: ['Excelå¯¼å…¥å¯¼å‡º', 'å…¬å¼è®¡ç®—', 'å›¾è¡¨åˆ¶ä½œ'],
      path: '/selection/table',
    },
  ];

  return (
    <div className="equipment-selection-page">
      <div className="page-header">
        <Title level={2}>âš™ï¸ è®¾å¤‡é€‰å‹å·¥å…·</Title>
        <Paragraph style={{ fontSize: 16, color: '#666' }}>
          æä¾›åŒ–å·¥è®¾å¤‡é€‰å‹ã€ç”µç¼†é€‰å‹ç­‰ä¸“ä¸šå·¥å…·
        </Paragraph>
      </div>

      <Row gutter={[24, 24]}>
        {tools.map(tool => (
          <Col xs={24} sm={24} md={8} key={tool.id}>
            <Card
              hoverable
              className="selection-tool-card"
              onClick={() => navigate(tool.path)}
            >
              <div style={{ textAlign: 'center', marginBottom: 20 }}>
                {tool.icon}
              </div>
              <Title level={4} style={{ textAlign: 'center', marginBottom: 12 }}>
                {tool.title}
              </Title>
              <Paragraph style={{ color: '#666', textAlign: 'center', marginBottom: 20 }}>
                {tool.description}
              </Paragraph>
              <div className="features-list">
                {tool.features.map((feature, index) => (
                  <div key={index} className="feature-item">
                    <span className="feature-dot">â—</span>
                    <span>{feature}</span>
                  </div>
                ))}
              </div>
            </Card>
          </Col>
        ))}
      </Row>
    </div>
  );
};

export default EquipmentSelection;
```

#### 2. é£æœºé€‰å‹é¡µé¢
**æ–‡ä»¶**: `client/src/pages/FanSelection.tsx`

```tsx
import React, { useEffect, useRef } from 'react';
import { Button, Space } from 'antd';
import { ArrowLeftOutlined, FullscreenOutlined } from '@ant-design/icons';
import { useNavigate } from 'react-router-dom';

const FanSelection: React.FC = () => {
  const navigate = useNavigate();
  const iframeRef = useRef<HTMLIFrameElement>(null);

  useEffect(() => {
    // ç›‘å¬ iframe åŠ è½½äº‹ä»¶
    const iframe = iframeRef.current;
    if (iframe) {
      iframe.onload = () => {
        console.log('é£æœºé€‰å‹ç³»ç»ŸåŠ è½½å®Œæˆ');
      };
    }
  }, []);

  const handleFullscreen = () => {
    if (iframeRef.current) {
      if (iframeRef.current.requestFullscreen) {
        iframeRef.current.requestFullscreen();
      }
    }
  };

  return (
    <div style={{ height: 'calc(100vh - 100px)', display: 'flex', flexDirection: 'column' }}>
      <div style={{ padding: '16px', background: '#fff', borderBottom: '1px solid #f0f0f0' }}>
        <Space>
          <Button icon={<ArrowLeftOutlined />} onClick={() => navigate('/selection')}>
            è¿”å›é€‰å‹å·¥å…·
          </Button>
          <Button icon={<FullscreenOutlined />} onClick={handleFullscreen}>
            å…¨å±æ˜¾ç¤º
          </Button>
        </Space>
      </div>
      <iframe
        ref={iframeRef}
        src="/selection-tools/fan-selector.html"
        style={{
          flex: 1,
          border: 'none',
          width: '100%',
        }}
        title="ç¦»å¿ƒé£æœºé€‰å‹ç³»ç»Ÿ"
      />
    </div>
  );
};

export default FanSelection;
```

#### 3. ç”µç¼†é€‰å‹é¡µé¢
**æ–‡ä»¶**: `client/src/pages/CableSelection.tsx`

```tsx
import React, { useRef } from 'react';
import { Button, Space } from 'antd';
import { ArrowLeftOutlined, FullscreenOutlined } from '@ant-design/icons';
import { useNavigate } from 'react-router-dom';

const CableSelection: React.FC = () => {
  const navigate = useNavigate();
  const iframeRef = useRef<HTMLIFrameElement>(null);

  const handleFullscreen = () => {
    if (iframeRef.current && iframeRef.current.requestFullscreen) {
      iframeRef.current.requestFullscreen();
    }
  };

  return (
    <div style={{ height: 'calc(100vh - 100px)', display: 'flex', flexDirection: 'column' }}>
      <div style={{ padding: '16px', background: '#fff', borderBottom: '1px solid #f0f0f0' }}>
        <Space>
          <Button icon={<ArrowLeftOutlined />} onClick={() => navigate('/selection')}>
            è¿”å›é€‰å‹å·¥å…·
          </Button>
          <Button icon={<FullscreenOutlined />} onClick={handleFullscreen}>
            å…¨å±æ˜¾ç¤º
          </Button>
        </Space>
      </div>
      <iframe
        ref={iframeRef}
        src="/selection-tools/cable-selector-table.html"
        style={{
          flex: 1,
          border: 'none',
          width: '100%',
        }}
        title="YJVç”µç¼†é€‰å‹ç³»ç»Ÿ"
      />
    </div>
  );
};

export default CableSelection;
```

#### 4. Luckysheetè¡¨æ ¼é¡µé¢
**æ–‡ä»¶**: `client/src/pages/LuckysheetTable.tsx`

```tsx
import React, { useRef } from 'react';
import { Button, Space } from 'antd';
import { ArrowLeftOutlined, FullscreenOutlined } from '@ant-design/icons';
import { useNavigate } from 'react-router-dom';

const LuckysheetTable: React.FC = () => {
  const navigate = useNavigate();
  const iframeRef = useRef<HTMLIFrameElement>(null);

  const handleFullscreen = () => {
    if (iframeRef.current && iframeRef.current.requestFullscreen) {
      iframeRef.current.requestFullscreen();
    }
  };

  return (
    <div style={{ height: 'calc(100vh - 100px)', display: 'flex', flexDirection: 'column' }}>
      <div style={{ padding: '16px', background: '#fff', borderBottom: '1px solid #f0f0f0' }}>
        <Space>
          <Button icon={<ArrowLeftOutlined />} onClick={() => navigate('/selection')}>
            è¿”å›é€‰å‹å·¥å…·
          </Button>
          <Button icon={<FullscreenOutlined />} onClick={handleFullscreen}>
            å…¨å±æ˜¾ç¤º
          </Button>
        </Space>
      </div>
      <iframe
        ref={iframeRef}
        src="/selection-tools/index.html"
        style={{
          flex: 1,
          border: 'none',
          width: '100%',
        }}
        title="åœ¨çº¿è¡¨æ ¼ç¼–è¾‘å™¨"
      />
    </div>
  );
};

export default LuckysheetTable;
```

#### 5. æ ·å¼æ–‡ä»¶
**æ–‡ä»¶**: `client/src/pages/EquipmentSelection.css`

```css
.equipment-selection-page {
  padding: 24px;
}

.page-header {
  margin-bottom: 32px;
}

.selection-tool-card {
  height: 100%;
  transition: all 0.3s ease;
  border-radius: 12px;
}

.selection-tool-card:hover {
  transform: translateY(-4px);
  box-shadow: 0 8px 24px rgba(0, 0, 0, 0.12);
}

.features-list {
  display: flex;
  flex-direction: column;
  gap: 8px;
}

.feature-item {
  display: flex;
  align-items: center;
  gap: 8px;
  font-size: 14px;
  color: #666;
}

.feature-dot {
  color: #1890ff;
  font-size: 8px;
}
```

### ç¬¬ä¸‰æ­¥ï¼šæ›´æ–°è·¯ç”±é…ç½®

ç¼–è¾‘ `client/src/App.tsx`ï¼Œæ·»åŠ æ–°è·¯ç”±ï¼š

```tsx
// å¯¼å…¥æ–°ç»„ä»¶
import EquipmentSelection from './pages/EquipmentSelection';
import FanSelection from './pages/FanSelection';
import CableSelection from './pages/CableSelection';
import LuckysheetTable from './pages/LuckysheetTable';

// åœ¨è·¯ç”±ä¸­æ·»åŠ 
<Routes>
  {/* è®¾å¤‡é€‰å‹ä¸»é¡µ */}
  <Route path="/selection" element={<EquipmentSelection />} />
  
  {/* é£æœºé€‰å‹ */}
  <Route path="/selection/fan" element={<FanSelection />} />
  
  {/* ç”µç¼†é€‰å‹ */}
  <Route path="/selection/cable" element={<CableSelection />} />
  
  {/* åœ¨çº¿è¡¨æ ¼ */}
  <Route path="/selection/table" element={<LuckysheetTable />} />
  
  {/* å…¶ä»–ç°æœ‰è·¯ç”±... */}
</Routes>
```

### ç¬¬å››æ­¥ï¼šæ›´æ–°ä¾§è¾¹æ èœå•

ç¼–è¾‘ `client/src/components/Layout/Sider.tsx`ï¼Œæ·»åŠ èœå•é¡¹ï¼š

```tsx
import { SelectOutlined } from '@ant-design/icons';

const menuItems = [
  // ç°æœ‰èœå•é¡¹...
  {
    key: '/selection',
    icon: <SelectOutlined />,
    label: 'è®¾å¤‡é€‰å‹',
  },
  // å…¶ä»–èœå•é¡¹...
];
```

---

## ğŸ¨ ç•Œé¢é¢„è§ˆ

### è®¾å¤‡é€‰å‹ä¸»é¡µ
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  âš™ï¸ è®¾å¤‡é€‰å‹å·¥å…·                        â”‚
â”‚  æä¾›åŒ–å·¥è®¾å¤‡é€‰å‹ã€ç”µç¼†é€‰å‹ç­‰ä¸“ä¸šå·¥å…·      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”         â”‚
â”‚  â”‚ ğŸ”§  â”‚  â”‚ âš¡  â”‚  â”‚ ğŸ“Š  â”‚         â”‚
â”‚  â”‚é£æœº   â”‚  â”‚ç”µç¼†   â”‚  â”‚è¡¨æ ¼   â”‚         â”‚
â”‚  â”‚é€‰å‹   â”‚  â”‚é€‰å‹   â”‚  â”‚ç¼–è¾‘   â”‚         â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”˜         â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### é£æœºé€‰å‹é¡µé¢
```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ â† è¿”å›  â›¶ å…¨å±                         â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                         â”‚
â”‚      [é£æœºé€‰å‹ç³»ç»Ÿ iframe]               â”‚
â”‚                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## ğŸ“¦ å®Œæ•´é›†æˆè„šæœ¬

æˆ‘å°†ä¸ºæ‚¨åˆ›å»ºä¸€ä¸ªè‡ªåŠ¨åŒ–é›†æˆè„šæœ¬ï¼Œä¸€é”®å®Œæˆæ‰€æœ‰æ“ä½œã€‚

---

## ğŸ”„ åç»­ä¼˜åŒ–å»ºè®®

### 1. æ•°æ®è”åŠ¨
- å°†é€‰å‹ç»“æœè‡ªåŠ¨ä¿å­˜åˆ°é¡¹ç›®æ•°æ®åº“
- åœ¨è®¾å¤‡ç®¡ç†ä¸­ç›´æ¥è°ƒç”¨é€‰å‹å·¥å…·
- é€‰å‹å†å²è®°å½•æŸ¥è¯¢

### 2. æƒé™æ§åˆ¶
- ä¸åŒè§’è‰²è®¿é—®ä¸åŒé€‰å‹å·¥å…·
- é€‰å‹ç»“æœå®¡æ ¸æµç¨‹

### 3. ç§»åŠ¨ç«¯é€‚é…
- å“åº”å¼è®¾è®¡
- ç§»åŠ¨ç«¯ä¸“ç”¨ç•Œé¢

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **è·¯å¾„é…ç½®**: ç¡®ä¿ `selection-tools` ç›®å½•åœ¨ `client/public/` ä¸‹
2. **è·¨åŸŸé—®é¢˜**: iframe åŒåŸŸï¼Œæ— è·¨åŸŸé—®é¢˜
3. **æµè§ˆå™¨å…¼å®¹**: éœ€è¦ç°ä»£æµè§ˆå™¨æ”¯æŒï¼ˆChrome, Edgeï¼‰
4. **æ€§èƒ½ä¼˜åŒ–**: å¤§å‹è¡¨æ ¼å¯èƒ½å½±å“æ€§èƒ½ï¼Œå»ºè®®æŒ‰éœ€åŠ è½½

---

## ğŸš€ ä¸‹ä¸€æ­¥

é€‰æ‹©é›†æˆæ–¹å¼ï¼š
- **å¿«é€Ÿä¸Šçº¿** â†’ ä½¿ç”¨æ–¹æ¡ˆ1ï¼ˆiframeåµŒå…¥ï¼‰
- **æ·±åº¦æ•´åˆ** â†’ ä½¿ç”¨æ–¹æ¡ˆ2ï¼ˆReactç»„ä»¶åŒ–ï¼‰

æˆ‘ç°åœ¨å¯ä»¥ä¸ºæ‚¨ï¼š
1. âœ… åˆ›å»ºè‡ªåŠ¨åŒ–é›†æˆè„šæœ¬
2. âœ… ç”Ÿæˆæ‰€æœ‰å¿…éœ€çš„ React ç»„ä»¶
3. âœ… æ›´æ–°è·¯ç”±å’Œèœå•é…ç½®
4. âœ… æµ‹è¯•é›†æˆæ•ˆæœ

**éœ€è¦æˆ‘ç«‹å³å¼€å§‹é›†æˆå—ï¼Ÿ** ğŸ‰

