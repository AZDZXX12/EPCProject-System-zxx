# Electron æ¡Œé¢ç‰ˆè°ƒè¯•æŒ‡å— ğŸ–¥ï¸

> åŸºäº Luckysheet é¡¹ç›®çš„æˆç†Ÿ Electron é…ç½®

---

## âœ… å·²å®Œæˆ

1. âœ… å¤åˆ¶ `main.js` - Electron ä¸»è¿›ç¨‹
2. âœ… å¤åˆ¶ `preload.js` - é¢„åŠ è½½è„šæœ¬
3. âœ… å¤åˆ¶ `electron-builder.yml` - æ‰“åŒ…é…ç½®
4. âœ… æ•´åˆ `package.json` - ä¾èµ–å’Œè„šæœ¬
5. âœ… åˆ›å»º `å¯åŠ¨Electron.bat` - ä¸€é”®å¯åŠ¨

---

## ğŸš€ ç«‹å³è°ƒè¯•

### æ–¹å¼1ï¼šä¸€é”®å¯åŠ¨ï¼ˆæ¨èï¼‰
```bash
# åŒå‡»è¿è¡Œ
å¯åŠ¨Electron.bat
```

### æ–¹å¼2ï¼šå‘½ä»¤è¡Œ
```bash
# ç¡®ä¿Electronå·²å®‰è£…
npm install

# å¯åŠ¨æ¡Œé¢åº”ç”¨
npm start
```

---

## ğŸ“¦ å½“å‰é…ç½®

### åŠ è½½å†…å®¹
- **è·¯å¾„**: `client/public/`
- **å…¥å£**: `client/public/selection-tools/index.html`
- **åŒ…å«**: å®Œæ•´çš„é€‰å‹ç³»ç»Ÿï¼ˆé£æœºã€ç”µç¼†ã€è¡¨æ ¼ï¼‰

### çª—å£è®¾ç½®
- å¤§å°: è‡ªåŠ¨é€‚åº”
- æœ€å°åŒ–: æ”¯æŒ
- å…¨å±: æ”¯æŒ
- å¼€å‘è€…å·¥å…·: F12

---

## ğŸ¯ main.js ç‰¹æ€§

ä» Luckysheet é¡¹ç›®ç»§æ‰¿çš„ç‰¹æ€§ï¼š

### 1. HTTP æœåŠ¡å™¨
- è‡ªåŠ¨å¯åŠ¨æœ¬åœ° HTTP æœåŠ¡å™¨
- ç«¯å£: 8080ï¼ˆé»˜è®¤ï¼‰
- æä¾›é™æ€æ–‡ä»¶æœåŠ¡

### 2. çª—å£ç®¡ç†
- è‡ªåŠ¨å±…ä¸­æ˜¾ç¤º
- è®°ä½çª—å£å¤§å°å’Œä½ç½®
- æ”¯æŒæœ€å°åŒ–å’Œå…¨å±

### 3. èœå•å®šåˆ¶
- æ–‡ä»¶èœå•
- ç¼–è¾‘èœå•
- æŸ¥çœ‹èœå•ï¼ˆåŒ…å«å¼€å‘è€…å·¥å…·ï¼‰
- å¸®åŠ©èœå•

### 4. è‡ªåŠ¨æ›´æ–°ï¼ˆå¯æ‰©å±•ï¼‰
- é¢„ç•™è‡ªåŠ¨æ›´æ–°æ¡†æ¶
- å¯é›†æˆåœ¨çº¿æ›´æ–°

---

## ğŸ“ æ–‡ä»¶è¯´æ˜

### main.js
```javascript
// Electron ä¸»è¿›ç¨‹
// åŠŸèƒ½:
// - åˆ›å»ºçª—å£
// - å¯åŠ¨HTTPæœåŠ¡å™¨
// - åŠ è½½åº”ç”¨
// - å¤„ç†ç³»ç»Ÿèœå•
```

### preload.js
```javascript
// é¢„åŠ è½½è„šæœ¬
// åŠŸèƒ½:
// - æš´éœ²å®‰å…¨çš„APIç»™æ¸²æŸ“è¿›ç¨‹
// - æ¡¥æ¥ä¸»è¿›ç¨‹å’Œæ¸²æŸ“è¿›ç¨‹
```

### electron-builder.yml
```yaml
# æ‰“åŒ…é…ç½®
# å®šä¹‰å¦‚ä½•æ‰“åŒ…æˆ .exe æ–‡ä»¶
```

---

## ğŸ”§ å¼€å‘è°ƒè¯•

### å¿«æ·é”®
| åŠŸèƒ½ | å¿«æ·é”® |
|------|--------|
| å¼€å‘è€…å·¥å…· | F12 |
| åˆ·æ–° | F5 æˆ– Ctrl+R |
| å…¨å± | F11 |
| é€€å‡º | Alt+F4 |

### æŸ¥çœ‹æ—¥å¿—
- **ä¸»è¿›ç¨‹æ—¥å¿—**: å¯åŠ¨Electronçš„å‘½ä»¤è¡Œçª—å£
- **æ¸²æŸ“è¿›ç¨‹æ—¥å¿—**: F12 â†’ Console

### è°ƒè¯•æŠ€å·§
1. æ‰“å¼€å¼€å‘è€…å·¥å…· (F12)
2. æŸ¥çœ‹ Network æ ‡ç­¾ï¼ˆç½‘ç»œè¯·æ±‚ï¼‰
3. æŸ¥çœ‹ Console æ ‡ç­¾ï¼ˆæ—¥å¿—ï¼‰
4. æŸ¥çœ‹ Application æ ‡ç­¾ï¼ˆå­˜å‚¨ï¼‰

---

## ğŸ“¦ æ‰“åŒ… EXE

### æµ‹è¯•æ‰“åŒ…
```bash
npm run pack
```
ç”Ÿæˆ: `release/win-unpacked/` (æœªæ‰“åŒ…ç‰ˆæœ¬)

### å®Œæ•´æ‰“åŒ…
```bash
npm run dist:win
```
ç”Ÿæˆ: `release/åŒ–å·¥é¡¹ç›®ç®¡ç†ç³»ç»Ÿ Setup 1.0.0.exe`

### æ‰“åŒ…é…ç½®
åœ¨ `package.json` ä¸­çš„ `build` éƒ¨åˆ†ï¼š
- `productName`: åº”ç”¨åç§°
- `appId`: åº”ç”¨ID
- `files`: åŒ…å«çš„æ–‡ä»¶
- `win`: Windows ç‰¹å®šé…ç½®
- `nsis`: å®‰è£…ç¨‹åºé…ç½®

---

## ğŸ¨ åº”ç”¨å†…å®¹

### å½“å‰åŒ…å«
- âœ… Luckysheet è¡¨æ ¼ç³»ç»Ÿ
- âœ… é£æœºé€‰å‹å·¥å…·
- âœ… ç”µç¼†é€‰å‹å·¥å…·
- âœ… æ‰€æœ‰é™æ€èµ„æº

### æ–‡ä»¶ç»“æ„
```
client/public/
â”œâ”€â”€ selection-tools/
â”‚   â”œâ”€â”€ index.html          # ä¸»å…¥å£
â”‚   â”œâ”€â”€ fan-selector.html   # é£æœºé€‰å‹
â”‚   â”œâ”€â”€ cable-selector-table.html  # ç”µç¼†é€‰å‹
â”‚   â”œâ”€â”€ libs/
â”‚   â”‚   â”œâ”€â”€ xlsx.full.min.js (æœ¬åœ°åŒ–)
â”‚   â”‚   â”œâ”€â”€ luckyexcel.js
â”‚   â”‚   â””â”€â”€ exceljs.min.js
â”‚   â”œâ”€â”€ css/
â”‚   â”œâ”€â”€ js/
â”‚   â””â”€â”€ ...
â””â”€â”€ ...
```

---

## âš™ï¸ é«˜çº§é…ç½®

### ä¿®æ”¹ç«¯å£
ç¼–è¾‘ `main.js`ï¼š
```javascript
const PORT = 8080; // æ”¹ä¸ºä½ æƒ³è¦çš„ç«¯å£
```

### ä¿®æ”¹çª—å£å¤§å°
ç¼–è¾‘ `main.js`ï¼š
```javascript
width: 1400,  // å®½åº¦
height: 900,  // é«˜åº¦
```

### ä¿®æ”¹åº”ç”¨åç§°
ç¼–è¾‘ `package.json`ï¼š
```json
"productName": "ä½ çš„åº”ç”¨åç§°"
```

---

## â“ å¸¸è§é—®é¢˜

### Q1: Electronçª—å£ç©ºç™½ï¼Ÿ
**ç­”**: æ£€æŸ¥ `client/public/selection-tools/index.html` æ˜¯å¦å­˜åœ¨

**è§£å†³**:
```bash
# ç¡®è®¤æ–‡ä»¶å­˜åœ¨
dir client\public\selection-tools\index.html
```

### Q2: XLSXåŠ è½½å¤±è´¥ï¼Ÿ
**ç­”**: å·²æœ¬åœ°åŒ–ï¼Œç¡®è®¤æ–‡ä»¶å­˜åœ¨ï¼š
```bash
dir client\public\selection-tools\libs\xlsx.full.min.js
```

### Q3: å¦‚ä½•é›†æˆReactå‰ç«¯ï¼Ÿ
**ç­”**: ä¿®æ”¹ `main.js` çš„åŠ è½½è·¯å¾„ï¼š
```javascript
// æ”¹ä¸º
mainWindow.loadURL(`http://localhost:${PORT}/`);
```

### Q4: æ‰“åŒ…åä½“ç§¯å¾ˆå¤§ï¼Ÿ
**ç­”**: æ­£å¸¸ï¼ŒElectronçº¦150-200MB

**ä¼˜åŒ–**:
- ä½¿ç”¨ ASAR å‹ç¼©
- æ’é™¤ä¸å¿…è¦çš„æ–‡ä»¶
- ä½¿ç”¨å¢é‡æ›´æ–°

### Q5: å¦‚ä½•æ·»åŠ å›¾æ ‡ï¼Ÿ
**ç­”**: 
1. å‡†å¤‡ `.ico` æ–‡ä»¶
2. åœ¨ `package.json` ä¸­é…ç½®ï¼š
```json
"win": {
  "icon": "path/to/icon.ico"
}
```

---

## ğŸ¯ ä¸‹ä¸€æ­¥

### å·²é›†æˆï¼ˆç«‹å³å¯ç”¨ï¼‰
- âœ… é€‰å‹ç³»ç»Ÿæ¡Œé¢åŒ–
- âœ… æœ¬åœ°åŒ–XLSXåº“
- âœ… å®Œæ•´åŠŸèƒ½
- âœ… å¯æ‰“åŒ…æˆEXE

### å¯æ‰©å±•
- [ ] é›†æˆReactå‰ç«¯
- [ ] é›†æˆPythonåç«¯
- [ ] æ·»åŠ æ‰˜ç›˜å›¾æ ‡
- [ ] æ·»åŠ è‡ªåŠ¨æ›´æ–°
- [ ] æ•°æ®æŒä¹…åŒ–

---

## ğŸ“ å‚è€ƒèµ„æ–™

### Luckysheet åŸé¡¹ç›®
- è·¯å¾„: `C:\Users\Administrator\Desktop\Luckysheet-master-2.0.2`
- å·²æ‰“åŒ…EXE: `release/Luckysheeté€‰å‹ç³»ç»Ÿ Setup 1.0.2.exe`
- å¯å‚è€ƒå­¦ä¹ 

### Electron æ–‡æ¡£
- å®˜ç½‘: https://www.electronjs.org/
- ä¸­æ–‡æ–‡æ¡£: https://www.electronjs.org/zh/docs/latest/

### æ‰“åŒ…å·¥å…·
- electron-builder: https://www.electron.build/

---

**çŠ¶æ€**: âœ… é…ç½®å®Œæˆï¼Œå¯ç«‹å³è°ƒè¯•  
**å‘½ä»¤**: `å¯åŠ¨Electron.bat` æˆ– `npm start`  
**æ‰“åŒ…**: `npm run dist:win`

**å¼€å§‹è°ƒè¯•å§ï¼** ğŸš€

